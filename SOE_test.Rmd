---
title: "The State of the Canadian Economy"
author: "Presentation to DGPC"
date: "January 16, 2024"
output:
  xaringan::moon_reader:
    self_contained: true
    css: [default,hygge-duke,chocolate-fonts]
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
class: middle, center, title-slide-background
background-size: contain
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
```

```{r, echo=FALSE, include=FALSE}
library(OECD)
library(rmarkdown)
library(tidyverse)
library(forecast)
library(xts)
library(rmarkdown)
library(openxlsx)
library(XML)
library(reshape2)
library(plyr)
library(ggplot2)
library(rCharts)
library(dplyr)
library(tidyr)
library(ggcharts)
library(ggpol)
library(RColorBrewer)
library(highcharter)
library(vtable)
library(webshot)
library(scales)
library(statcanR)
library(tidyverse)
library(writexl)
library(highcharter)  # Make sure you have the highcharter library installed
library(readxl)
```

.left[
## Key Messages
.pull-left[
- <span style="font-size: 22px;"> 
Higher interest rates will continue to weigh on economic activity. While a soft landing is within reach, <strong>Canadian consumers and businesses are under pressure </strong>from rising costs, which could limit growth prospects in 2024.

- <span style = "font-size:22px;">
Tackling weak productivity growth in Canada remains a critical economic challenge. The <strong>twin transitions of green and digital present opportunities to unlock new productivity avenues</strong>.

- <span style = "font-size:22px;">
<strong>Sub-optimal business investment</strong> should continue to <strong>raise alarm bells </strong>as it is a key factor for higher incomes and living standards in Canada
</span>
]
]

.pull-right[
<img src = "keymessages.jpg" width = "90%"/>
]
---
<center>
<img src = "recentdev.jpg" width = "80%"/>
</center>
---
class: inverse
```{css, echo=FALSE}
.inverse {
  background-color: #4F6367; /* Replace with your desired color code */
}
```
.left[
##Recent Developments
.pull-left[
<img src="gan.jpg" width="90%"/>
]
]

.pull-right[
- <span style="font-size: 32px;"> 
ECONOMIC DASHBAORD 
</span>
  
- <span style="font-size: 32px;">
SECTOR SNAPSHOT
</span>

- <span style="font-size: 32px;">
LOOKING AHEAD
</span>
]
---

```{r Econ dashboard called Test, include=FALSE, echo=FALSE}

# Data similar to the one in the image uploaded
data <- data.frame(
  categories = c("Monthly GDP", "Inflation", "Interest Rate", "Unemployment",
                 "Business Confidence Index", "Consumer Confidence Index", 
                 "Exports Growth", "Business Investment", "Business Insolvencies"),
  values = c(0.1, -3.1, -5, 5.8, -3.4, 3.7, 2.2, 2.4, 3.5), # Mock values
  periods = c("Sept.", "Oct.", "Nov.", "Nov.", "Nov.", "Nov.", "Oct.", "Q2 2023", "Q3 2023"),
  colors = c("#FF0000", "#FF0000", "#FF0000", "#FF0000",  # Red for first 4
             "#7a9e9f", "#7a9e9f",                        # Teal for next 2
             "#FFD700", "#FFD700", "#FFD700")             # Yellow for last 3
)

# Parse the data for highcharter
data_list <- lapply(1:nrow(data), function(i) {
  list(
    name = data$categories[i],
    y = data$values[i],
    color = data$colors[i]
  )
})

# Create the highchart object with customized colors
test<-highchart() %>%
  hc_chart(type = 'column') %>%
  #hc_title(text = "Economic Dashboard") %>%
  #hc_subtitle(text = "Growth comes to a halt as higher rates start to impact businesses and labor") %>%
  hc_xAxis(categories = data$categories) %>%
  hc_yAxis(title = list(text = "Monthly Percentage Change")) %>%
  hc_add_series(name = "Economic Indicators", data = data_list, dataLabels = list(enabled = TRUE)) %>%
  hc_tooltip(formatter = JS("function() { return this.x + ': <b>' + this.y + '%</b> '; }")) %>%
  hc_plotOptions(series = list(
    dataLabels = list(enabled = TRUE, format = '{y:.1f}%')
  ))

```

###Growth comes to a halt as higher rates start to impact businesses and labor

```{r, echo=FALSE, out.width='100%', include=FALSE, fig.align='center', class='centered-plot'}
test
```
<center>
<img src = "dashboard.jpg" width = "190%"/>
</center>

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> <strong>Economic dashboard</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>
---
### Monetary policy tightening is starting to impact growth
#### GDP contracted by 0.3% in the third quarter as the effects of higher interest rates trickle through the economy 

.pull-left[
- <span style="font-size: 22px;"> 
Canada's economy shrank in the three months up to September, as business investments and exports declined while consumer spending remained flat.

- <span style="font-size: 22px;"> 
The effects of interest rate increases will continue to restrain spending, while limiting growth and employment (see Annex A). 

- <span style="font-size: 22px;"> 
Recent private sector forecasts project either <strong>weak or negative growth over the next two quarters</strong> (see Annex B). 

</span>
]


```{r, echo=FALSE}
monetary <- read_excel("C:/Users/davreuxa/Documents/soe/monetary.xlsx")

monetary1<- monetary %>%
  pivot_longer(-indicator, names_to = "Quarter", values_to = "Value")%>%
  pivot_wider(names_from = `indicator`, values_from = `Value`)

monetary_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = monetary1$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "GDP Quarterly Growth"),
      opposite = FALSE
    ),
    list(
      title = list(text = "Bank of Canada Policy Interest Rate"),
      opposite = TRUE
    )
  ) %>%
  hc_add_series(
    name = "GDP quarterly growth",
    data = monetary1$`GDP Quarterly Growth`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_plotOptions(
    column = list(
      colorByPoint = TRUE,
      colors = ifelse(monetary1$`GDP Quarterly Growth` < 0, "#E31737", "#333F50")
    )
  ) %>%
  hc_add_series(
    name = "Bank of Canada Policy Interest Rate",
    data = monetary1$`Bank of Canada Policy Interest Rate`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Statistics Canada, Table 36-10-0434-01; Gross domestic product (GDP) at basic prices, by industry, monthly (x 1,000,000), Bank of Canada, target for the overnight rate"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )
```

```{r, echo=FALSE}
monetary_chart
```

---
###What's the economic outlook?
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
proj<-highchart() %>%
  hc_chart(type = "line") %>%
  hc_title(text = "Real GDP growth, past and projected, for selected countries and the world, yearly, percentage ") %>%
  hc_xAxis(categories = c(2022, 2023, 2024, 2025),
           plotBands = list(
             list(
               from = 0.5,  # Assuming the categories are zero-indexed
               to = 3.5,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = "GDP Growth (%)")) %>%
  hc_add_series(name = "Canada, previous projection", data = c(3.4, 1.8, 1.2, 2.4)) %>%
  hc_add_series(name = "Canada, current projection", data = c(3.4, 1.2, 0.9, 2.5)) %>%
  hc_add_series(name = "World, current projection", data = c(3.4, 2.9, 2.3, 2.6)) %>%
  hc_add_series(name = "World, previous projection", data = c(3.4, 2.8, 2.4, 2.7)) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c('#FFBBAB', '#FF0000', 'black', 'grey')) %>%
  hc_add_theme(hc_theme_bloom()) 


```
<center>
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
proj
```
</center>
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Looking ahead</strong></span>
</div>
---
class: inverse


.left[
##Current Headwinds
.pull-left[
<img src="yukon.jpg" width="90%"/>
]
]

.pull-right[
- <span style="font-size: 32px;"> 
WAGE-PRICE SPIRAL RISKS
</span>
  
- <span style="font-size: 32px;">
PRICE OF INTRANTS
</span>

- <span style="font-size: 32px;">
CORPORATE DEBT INSOLVENCIES
</span>
]

---
###Wages are finally catching up with inflation, adding cost pressure on firms

.pull-left[
-Workers have seen their average wages rise at the same rate as inflation in 2023 (+3.0% up to September)

-From the firmâ€™s perspective, the cost of labor has been rising faster than the increase in price of the products sold for the last four quarters

-On a sectoral basis, wages in the service-producing industries have been growing faster than inflation in 2023, resulting in positive real wage growth (+0.6%), while those in the goods-producing industries are trailing behind (-0.8%) (up to September)


]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6, warning=FALSE}
cons <- read_excel("C:/Users/davreuxa/Documents/soe/construction.xlsx")



const <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = cons$Quarter) %>%
  hc_add_series(
    name = "Change in the cost of labor",
    data = cons$`Change in the cost of labor`,
    dataLabels = list(enabled = TRUE, format = '{point.y:.2f}%')
  ) %>%
    hc_add_series(
    name = "Change in the price of goods sold",
    data = cons$`Change in the price of goods sold`,
    dataLabels = list(enabled = TRUE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0104-01"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_title(text = "Quarterly change in the unit labor cost, and the implicit price deflator, percentage")%>%
  hc_colors(colors = c( "#7a9e9f","#b8d8d8"))

```

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=6}
const
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #7A9E9F; text-align: center;">
 <span class="small-font"> <strong>Wage-Price Spiral Risks</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Price of intrants </span>
  <span class="small-font" style="margin-left: 100px;">Corporate debt and insolvencies</span>
</div>
---
###Price of Intrants
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #7A9E9F; text-align: center;">
 <span class="small-font"> Wage-Price Spiral Risks</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Price of intrants </strong></span>
  <span class="small-font" style="margin-left: 100px;">Corporate debt and insolvencies</span>
</div>
---
### Business insolvency rates have surpassed pre-pandemic levels for the vast majority of industries

.pull-left[
-Non-financial corporations continue to borrow more, increasing their total debt by **1.5% in Q3 2023** and their interest expenses are rapidly increasing, reaching their highest recorded value of $22.8 billion


-As of August 2023, most industries had a higher business insolvency rate compared to pre-pandemic, with the notable exception of information and cultural industries and construction


-Tourism-related industries, energy and manufacturing have the highest insolvency rates and are trending up



]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6, warning=FALSE}
debt <- read_excel("C:/Users/davreuxa/Documents/soe/debt.xlsx")



debt1 <- highchart() %>%
  hc_chart(type = "bar", zoomType = "xy") %>%
  hc_xAxis(categories = debt$`Industry`) %>%
  hc_add_series(
    name = "Jan-Aug2023",
    data = debt$`Jan-Aug 2023`
  ) %>%
    hc_add_series(
    name = "Jan-Aug2019",
    data = debt$`Jan-Aug 2019`
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0104-01"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_title(text = "Quarterly change in the unit labor cost, and the implicit price deflator, percentage")%>%
  hc_colors(colors = c( "#7a9e9f","#b8d8d8"))


```

.pull-right[
```{r, echo=FALSE, warning=FALSE}
debt1
```

]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #7A9E9F; text-align: center;">
 <span class="small-font"> Wage-Price Spiral Risks</span> 
  <span class="small-font" style="margin-left: 100px;">Price of intrants </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Corporate debt and insolvencies</strong></span>
</div>
---
class: inverse

class: inverse


.left[
##A Policy Agenda
.pull-left[
<img src="vic.jpg" width="100%"/>
]
]

.pull-right[
- <span style="font-size: 32px;"> 
BERD
</span>
  
- <span style="font-size: 32px;">
REGIONAL PRODUCTIVITY
</span>

- <span style="font-size: 32px;">
TRADE RESTRICTIONS 
</span>

- <span style="font-size: 32px;">
LAG IN CONSTRUCTION
</span>

- <span style="font-size: 32px;">
INVESTMENTS IN BATTERIES
</span>

- <span style="font-size: 32px;">
CRITICAL MINERALS
</span>
]

---
###Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels
```{r, echo=FALSE, include=FALSE}

# Create a data frame with the GDP growth information
gdp_growth <- data.frame(
  Industry = c(
    "Professional services", "Public administration", "Finance and insurance", 
    "Health care and social assistance", "Educational services", "Real estate and rental and leasing", 
    "Retail trade", "Information and cultural industries", "Other services", "Wholesale trade", 
    "Energy and mining", "Manufacturing", "Construction", "Transportation and warehousing", 
    "Utilities", "Administrative and support", "Accommodation and food services", 
    "Agriculture, forestry, fishing and hunting", "Arts, entertainment and recreation"
  ),
  RelativeToPrePandemic = c(
    11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -0.2, -2.4, 
    -4.1, -5.3, -7.0, -8.9, -7.3
  ),
  PastYear = c(
    1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -0.7, 4.5, 
    -6.4, 0.1, 0.0, -15.7, 7.4
  ),
  PastThreeMonths = c(
    -0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, 
    -2.2, -0.6, -1.0, 1.0, -7.5
  )
)

# Create the Highchart
sect<-highchart() %>%
  hc_chart(type = "bar") %>%
  hc_title(text = "Sector Snapshot") %>%
  hc_subtitle(text = "Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels") %>%
  hc_xAxis(categories = gdp_growth$Industry) %>%
  hc_yAxis(title = list(text = "GDP growth (%)")) %>%
  hc_add_series(name = "Relative to pre-pandemic", data = gdp_growth$RelativeToPrePandemic) %>%
  hc_add_series(name = "Past year", data = gdp_growth$PastYear) %>%
  hc_add_series(name = "Past three months", data = gdp_growth$PastThreeMonths) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_tooltip(pointFormat = "<span style='color:{point.color}'>\u25CF</span> {series.name}: <b>{point.y}%</b><br/>")

sect

```
```{r,echo=FALSE}
industries <- c("Professional services", "Public administration", "Finance and insurance",
                "Health care and social assistance", "Educational services",
                "Real estate and rental and leasing", "Retail trade",
                "Information and cultural industries", "Other services", "Wholesale trade",
                "Energy and mining", "Manufacturing", "Construction",
                "Transportation and warehousing", "Utilities", "Administrative and support",
                "Accommodation and food services", "Agriculture, forestry, fishing and hunting",
                "Arts, entertainment and recreation")

pre_pandemic <- c(11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -1.2, -2.4, -4.1, -5.3, -7.0, -7.3, -8.9)
past_year <- c(1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -1.7, 4.5, -6.4, 0.1, 0.0, -15.7, 7.4)
past_three_months <- c(-0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, -2.2, -0.6, -1.0, 1.0, -7.5)

# Create a list of lists for highcharter
data_for_chart <- list(
  list(name = 'Relative to pre-pandemic', data = pre_pandemic),
  list(name = 'Past year', data = past_year),
  list(name = 'Past three months', data = past_three_months)
)

# Create the Highchart
sect2<-highchart() %>%
  hc_chart(type = 'bar') %>%
  hc_title(text = "GDP growth by industry, as of August 2023, percentage") %>%
  hc_xAxis(categories = industries) %>%
  hc_yAxis(title = list(text = "Growth (%)")) %>%
  hc_add_series_list(data_for_chart) %>%
  hc_plotOptions(series = list(stacking = 'normal')) %>%
  hc_legend(reversed = TRUE) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE) 
  #hc_exporting(enabled = TRUE) # Enable chart exporting (optional)

```
<center>
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
sect2
```
</center>

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Sector snapshot</strong></span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>

---

