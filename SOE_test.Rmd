---
title: "The State of the Canadian Economy"
author: " "
date: "January 2024"
output:
  xaringan::moon_reader:
    self_contained: true
    css: [default,hygge-duke,chocolate-fonts]
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
class: middle, center, title-slide-background
background-size: contain
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
```

```{r, echo=FALSE, include = FALSE}
library(OECD)
library(rmarkdown)
library(tidyverse)
library(forecast)
library(xts)
library(rmarkdown)
library(openxlsx)
library(XML)
library(reshape2)
library(plyr)
library(ggplot2)
library(rCharts)
library(dplyr)
library(tidyr)
library(ggcharts)
library(ggpol)
library(RColorBrewer)
library(highcharter)
library(vtable)
library(webshot)
library(scales)
library(statcanR)
library(tidyverse)
library(writexl)
library(highcharter)  # Make sure you have the highcharter library installed
library(readxl)
```

.left[
## Key Messages
.pull-left[
- <span style="font-size: 22px;"> 
<strong> The Canadian economy facing multiple headwinds pointing to slow economic activity </strong>in the first half of 2024.


- <span style = "font-size:22px;">
<strong>High costs and debt levels </strong>continue to put pressure on Canadian consumers and businesses, <strong>creating a drag on the economy.</strong>


- <span style = "font-size:22px;">
<strong>Weak and declining productivity a critical challenge </strong>for Canadian businesses and near-term economic growth prospects. 

- <span style = "font-size:22px;">
<strong>Sub-optimal business investment also a significant contributing factor <strong>to weak economic outlook. 

</span>
]
]

.pull-right[
<img src = "keymessages.jpg" width = "90%" height = "150%"/>
]
---
<center>
<img src = "recentdev.jpg" width = "77.5%"/>
</center>

---

```{r Econ dashboard called Test, include=FALSE, echo=FALSE}

# Data similar to the one in the image uploaded
data <- data.frame(
  categories = c("Monthly GDP", "Inflation", "Interest Rate", "Unemployment",
                 "Business Confidence Index", "Consumer Confidence Index", 
                 "Exports Growth", "Business Investment", "Business Insolvencies"),
  values = c(0.1, -3.1, -5, 5.8, -3.4, 3.7, 2.2, 2.4, 3.5), # Mock values
  periods = c("Sept.", "Oct.", "Nov.", "Nov.", "Nov.", "Nov.", "Oct.", "Q2 2023", "Q3 2023"),
  colors = c("#FF0000", "#FF0000", "#FF0000", "#FF0000",  # Red for first 4
             "#7a9e9f", "#7a9e9f",                        # Teal for next 2
             "#FFD700", "#FFD700", "#FFD700")             # Yellow for last 3
)

# Parse the data for highcharter
data_list <- lapply(1:nrow(data), function(i) {
  list(
    name = data$categories[i],
    y = data$values[i],
    color = data$colors[i]
  )
})

# Create the highchart object with customized colors
test<-highchart() %>%
  hc_chart(type = 'column') %>%
  #hc_title(text = "Economic Dashboard") %>%
  #hc_subtitle(text = "Growth comes to a halt as higher rates start to impact businesses and labor") %>%
  hc_xAxis(categories = data$categories) %>%
  hc_yAxis(title = list(text = "Monthly Percentage Change")) %>%
  hc_add_series(name = "Economic Indicators", data = data_list, dataLabels = list(enabled = TRUE)) %>%
  hc_tooltip(formatter = JS("function() { return this.x + ': <b>' + this.y + '%</b> '; }")) %>%
  hc_plotOptions(series = list(
    dataLabels = list(enabled = TRUE, format = '{y:.1f}%')
  ))

```
.center[
##Growth comes to a halt as higher rates start to impact businesses and labour
]

<center>
<img src = "dashboard.jpg" width = "190%"/>
</center>

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> <strong>Economic dashboard</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>
---
.center[
## Monetary policy tightening is starting to impact growth
]
<ul style="font-size: 24px;">
GDP contracted by 0.3% in the third quarter as the effects of higher interest rates trickle through the economy.</ul>


.pull-left[
- <span style="font-size: 22px;"> 
<strong>Canada's economy shrank </strong>in the three months up to September 2023. 


- <span style="font-size: 22px;"> 
<strong>Business investments and exports </strong>declined while consumer spending remained flat.


- <span style="font-size: 22px;"> 
Effects of interest rate increases expected to continue to restrain spending, while limiting growth and employment. 

</span>
]


```{r, echo=FALSE}
monetary <- read_excel("C:/Users/davreuxa/Documents/soe/monetary.xlsx")

monetary1<- monetary %>%
  pivot_longer(-indicator, names_to = "Quarter", values_to = "Value")%>%
  pivot_wider(names_from = `indicator`, values_from = `Value`)

monetary_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = monetary1$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "GDP Quarterly Growth"),
      opposite = FALSE
    ),
    list(
      title = list(text = "Bank of Canada Policy Interest Rate"),
      opposite = TRUE
    )
  ) %>%
  hc_add_series(
    name = "GDP quarterly growth",
    data = monetary1$`GDP Quarterly Growth`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_plotOptions(
    column = list(
      colorByPoint = TRUE,
      colors = ifelse(monetary1$`GDP Quarterly Growth` < 0, "#E31737", "#333F50")
    )
  ) %>%
  hc_add_series(
    name = "Bank of Canada Policy Interest Rate",
    data = monetary1$`Bank of Canada Policy Interest Rate`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada, Table 36-10-0434-01; Gross domestic product (GDP) at basic prices, by industry, monthly (x 1,000,000);</br /> Bank of Canada, target for the overnight rate", style = list(fontSize = "9px")
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )%>%
  hc_subtitle(text="GDP growth, monthly (left, %), compared to the Bank of Canada's policy interest rate (right, %)", 
              style = list(fontSize = "16px"),
              align = "center"
              )
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6.25}
monetary_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic dashboard</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Monetary policy</strong></span>
  <span class="small-font" style="margin-left: 100px;">Looking ahead</span>
</div>

---
.center[
##Weak short-term economic outlook expected 
]
<ul style="font-size: 24px;">
Canadian economy expected to slow in early 2024, improving in second half of the year.</ul>


.pull-left[
- <span style="font-size: 22px;"> 
Economic growth expected to be weak or <strong>negative over the next two quarters in 2024.</strong>


- <span style="font-size: 22px;"> 
High interest rates expected to <strong>dampen business investments </strong>while weaker global demand could reduce exports.

- <span style="font-size: 22px;"> 
<strong>The unemployment rate is expected to gradually increase to 6.5% (from current 5.8%) by the end of 2024,</strong> as slower hiring rates continue to cool down a tight labour market.


</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
proj<-highchart() %>%
  hc_chart(type = "line") %>%
  hc_subtitle(text = "Real GDP growth, past and projected, for Canada and the world (annualized growth rate) ", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_xAxis(categories = c(2022, 2023, 2024, 2025),
           plotBands = list(
             list(
               from = 0.5,  # Assuming the categories are zero-indexed
               to = 3.5,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = "GDP Growth (%)")) %>%
  hc_add_series(name = "Canada, previous projection", data = c(3.4, 1.8, 1.2, 2.4)) %>%
  hc_add_series(name = "Canada, current projection", data = c(3.4, 1.2, 0.9, 2.5)) %>%
  hc_add_series(name = "World, previous projection", data = c(3.4, 2.8, 2.4, 2.7)) %>%
  hc_add_series(name = "World, current projection", data = c(3.4, 2.9, 2.3, 2.6)) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c('#FFBBAB', '#FF0000', 'grey', 'black')) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Bank of Canada's Monetary Policy Report, July 2023 projections vs. October 2023 projections", style = list(fontSize = "9px")
  ) 
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6.5}
proj
```
]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Looking ahead</strong></span>
</div>
---
<center>
<img src = "currenthead.jpg" width = "77.5%"/>
</center>
---
.center[
## Elevated debt levels will dampen opportunities for investment 
]

.pull-left[
<ul style="font-size: 24px;">
Constrained government fiscal environment.</ul>

- <span style="font-size: 17px;"> 
Current federal debt ~42% of GDP, places Canada with third lowest public-debt-to-GDP ratio among G7, above the UK and Germany.
```{r, echo=FALSE, fig.width=6, fig.height=5.25}
feddebt <- read_excel("C:/Users/davreuxa/Documents/soe/feddebttogdp.xlsx")


feddebt_graph <- highchart() %>%
  hc_chart(type = "line") %>%
  hc_subtitle(text = "Federal Debt-to-GDP ratio", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_xAxis(categories = feddebt$Date,
           plotBands = list(
             list(
               from = 7,  # Assuming the categories are zero-indexed
               to = 13,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = " ")) %>%
  hc_add_series(name = "Actual values ", data = feddebt$`Federal debt to GDP`) %>%
  hc_add_series(name = "Projected values ", 
                data = feddebt$Forecast,
                dashStyle = "Dash") %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = FALSE, crosshairs = TRUE) %>%
  hc_colors(colors = c("grey", "#A4B9CE")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Fall Economic Statement 2023", style = list(fontSize = "9px")
  )

feddebt_graph
```

]
.pull-right[
<ul style="font-size: 24px;">
Corporate debt reaches record levels.</ul>
- <span style="font-size: 17px;"> 
Interest charges reached $22.9 billion in Q3 2023, with banks bracing for higher level of insolvencies.
```{r, echo=FALSE, fig.width=7, fig.height=5.90}
corpdebt <- read_excel("C:/Users/davreuxa/Documents/soe/corpdebt.xlsx")

corpdebt_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_subtitle(text = "Total debt of non-financial corporations(left), and interest rate charges(right)", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_xAxis(categories = corpdebt$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "$ billion"),
      opposite = FALSE,
      min=1400,
      max=1800
    ),
    list(
      title = list(text = "%"),
      opposite = TRUE,
      min = 15, # Set the minimum bound
      max = 23  # Set the maximum bound
    )
  ) %>%
  hc_add_series(
    name = "Total debt of non-financial corporations",
    data = corpdebt$`Total debt of non-financial corporations (left)`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_add_series(
    name = "Interest rate charges",
    data = corpdebt$`Interest charges (right)`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Quarterly balance sheet, income statement, and selected financial ratios, </br /> by non-financial industries, non-seasonally adjusted (billions).", style = list(fontSize = "9px")
  ) %>%
  hc_colors(colors = c("#A4B9CE","grey")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )

corpdebt_chart
```
]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> <strong>Debt</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Canadian households remain under significant pressure 
]
<ul style="font-size: 24px;">
Affordability remains a key issue, creating a drag on consumption.</ul>

.pull-left[
- <span style="font-size: 22px;"> 
<strong>High demand</strong> and a <strong>lack of supply </strong>in the housing market offset gains in household income.

- <span style="font-size: 22px;"> 
The Bank of Canada’s <strong>housing affordability index reached its highest level </strong>— meaning the worst degree of affordability — since 1982.

- <span style="font-size: 22px;"> 
Canadian households allocating a <strong>higher portion of income to housing </strong>– on average, 55% towards total housing costs as of Q3 2023 – almost twice the rate compared to Q3 2019.

- <span style="font-size: 22px;"> 
Average household spending of <strong>~15 cents of every after-tax dollar to service debt </strong>– the highest since 1990, which could limit consumer spending.

</span>
]

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.45, fig.height=6.95}
housecost <- read_excel("C:/Users/davreuxa/Documents/soe/housecost.xlsx")

housecost_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = housecost$Date) %>%
  hc_add_series(
    name = "Housing affordability index, quarterly",
    data = housecost$`Value`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%"),
    plotLines = list(
      list(
        color = '#446992',          # Color of the dashed line
        width = 2,              # Width of the line
        dashStyle = 'Dash',     # Style of the line
        value = 0.55,           # The y-value where the dashed line is drawn
        zIndex = 5,             # Ensures that the line is above the plot
        label = list(
          text = 'Highest level in 41 years',
          align = 'right',
          style = list(
            color = '#446992'
          )
        )
      )
    )
  ) %>%
  hc_caption(
    text = "Source: Bank of Canada, Housing Affordibility.", style = list(fontSize = "9px")
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Housing costs are taking an ever increasing share of households' income", 
           style = list(fontSize = "20px"),
           align = "center") %>%
  hc_subtitle(text="Housing affordability index, quarterly", 
              style = list(fontSize = "16px"),
              align = "center")%>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_legend(enabled = FALSE) 


# To display the chart if you're running this in an interactive R session
housecost_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
  <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Affordability</strong> </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
## Inf lationary pressures might be easing
]
<ul style="font-size: 24px;">
Inflation is generally easing down despite a recent uptick.</ul>


.pull-left[
- <span style="font-size: 22px;"> 
<strong>Canada's consumer price index rose by 3.4% </strong>in the year up to December, bringing the inflation cooldown to a halt.

- <span style="font-size: 22px;"> 
Overall, <strong>shelter costs (e.g. mortgage and rent payments) are up by more than 6% </strong> in the past year, ~twice the overall inflation rate.

- <span style="font-size: 22px;"> 
<strong>CPI – food purchased from stores was 4.7%,</strong> marking a fifth month of deceleration.

- <span style="font-size: 22px;"> 
Historical experience suggests that the recent easing of cost pressures in production and distribution will lead to <strong>further declines in food price inflation </strong>over the coming months.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.width=7.45, fig.height=6.95}
foodinf <- read_excel("C:/Users/davreuxa/Documents/soe/foodinf.xlsx")

foodinf_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = format(as.Date(foodinf$Date), "%b %y"),
           labels = list(
      rotation = -90,  # Rotate the labels to vertical position
      align = "right",
      step = 1 # Increase x-axis label font size
    )
  ) %>%
  hc_add_series(
    name = "Food Inflation",
    data = foodinf$`Food Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "Headline Inflation",
    data = foodinf$`Headline Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Table 18-10-0006-01 Consumer Price Index, monthly", style = list(fontSize = "9px")
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Food inflation continues to decrease from its January 2023 peak, getting closer to the all-items inflation", 
           style = list(fontSize = "20px"),
           align = "center") %>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_subtitle(text="Year-over-year inflation, monthly (%)", 
              style = list(fontSize = "16px"),
              align = "center")

# To display the chart if you're running this in an interactive R session


foodinf_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Inflation</strong></span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Risks of a wage-price spiral
]
<ul style="font-size: 24px;">
Wages are catching up with inflation, adding cost pressures to firms.</ul>


.pull-left[
- <span style="font-size: 22px;"> 
<strong>Wage increases have become more widespread </strong>as workers try to recoup purchasing power including via several high-profile strikes across Canada.

- <span style="font-size: 22px;"> 
<strong>Labour costs rose faster </strong>than the increase in price of the products sold for the better part of the year (see chart).

- <span style="font-size: 22px;"> 
Though faster wage increases are an understandable reaction to higher inflation, they risk making a <strong>return to low inflation </strong>more difficult.


</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=5.80, warning=FALSE}
cons <- read_excel("C:/Users/davreuxa/Documents/soe/construction.xlsx")


const <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = cons$Quarter) %>%
  hc_add_series(
    name = "Change in the cost of labor",
    data = cons$`Change in the cost of labor`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "Change in the price of goods sold",
    data = cons$`Change in the price of goods sold`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%"),
    min=-2,
    max=4
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0206-01 Indexes of business sector labour productivity, unit labour cost </br />and related measures, seasonally adjusted.", style = list(fontSize = "9px")
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_subtitle(text = "Quarterly change in labor cost vs.  the implicit price deflator, %", 
              style = list(fontSize = "16px"),
              align = "center")%>%
  hc_title(text="The increase in cost of wages has outpaced the increase in prices of products sold for four consecutive quarters, before a recent uptick in prices.", 
           style = list(fontSize = "20px"),
           align = "center")%>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_add_annotation( 
  labels = list(
    list(
      point = list(
        xAxis = 0,
        yAxis = 0,
        x = 6,
        y = 2
      ),
      text = "The cost of labour has increased    , </br />
              faster than the rise in prices <br />",
      draggable = FALSE,  # Set draggable to TRUE or FALSE
      labelOptions = list(
        shape = 'connector',
        align = 'right',
        justify = FALSE,
        crop = FALSE,
        style = list(
          fontSize = '10px',
          textOutline = '1px white'
        )
      )
    )
  )
)
```

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.75}
const
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Inflation</strong></span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Weak, declining productivity growth concerning
]
<ul style="font-size: 24px;">
Canada’s productivity dipped below pre-pandemic levels, widening the gap with the U.S.</ul>

.pull-left[
- <span style="font-size: 22px;"> 
<strong>Canada’s productivity level is declining –  </strong>compared to last year, the average Canadian is now producing 2% less during every hour they spend at work.

- <span style="font-size: 22px;"> 
Since 2020, <strong> output per hour in the business sector has dropped at an annual rate of 0.2% –</strong> the first negative reading on record (see chart). 


- <span style="font-size: 22px;"> 
Canada’s labour productivity gap with the U.S. further deteriorated – as of 2022, <strong>Canada was 72% as productive as the U.S.</strong>. 

</span>
]
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.95}
LP <- read_excel("C:/Users/davreuxa/Documents/soe/LP.xlsx")

lp_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = LP$Quarter) %>%
  hc_add_series(
    name = "Canada",
    data = LP$Canada,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "US",
    data = LP$US,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source:Statistics Canada, US Federal Reserve Economic Data", style = list(fontSize = "9px")
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_subtitle(text = "Labour productivity in the business sector, Canada vs. US, annualized 4-year change (%)", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_title(text="Canada's labour productivity growth is now below pre-pandemic levels", 
           style = list(fontSize = "20px"),
           align = "center")%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))%>%
  hc_add_annotation( 
  labels = list(
    list(
      point = list(
        xAxis = 0,
        yAxis = 0,
        x = 105,
        y = 2
      ),
      text = "The productivity gap between Canada   , </br />
                and the U.S.is increasing <br />",
      draggable = FALSE,  # Set draggable to TRUE or FALSE
      labelOptions = list(
        shape = 'connector',
        align = 'center',
        justify = FALSE,
        crop = TRUE,
        style = list(
          fontSize = '10px',
          textOutline = '1px white'
        )
      )
    )
  )
)

lp_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Productivity</strong></span>

</div>
---
<center>
<img src = "blueprint.jpg" width = "55%"/>
</center>
---

```{r, echo=FALSE,  include=FALSE}
TFP <- read_excel("C:/Users/davreuxa/Documents/soe/TFP.xlsx")

multiplier <- 100

# Apply the multiplier to all columns except 'Date'
TFP[, -which(names(TFP) == "Date")] <- TFP[, -which(names(TFP) == "Date")] * multiplier


labor_growth_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Labour Productivity Growth",
           align = "center") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$LP_Can)%>%
  hc_add_series(name = "USA", data = TFP$LP_US) %>%
   hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  #hc_subtitle(text="Canada-U.S. Decomposition of Labour Productivity Growth, 1987-2021")


capital_deepening_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Capital Deepening",
              align = "center") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$CD_Can)%>%
  hc_add_series(name = "USA", data = TFP$CD_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  #hc_title(text="Canada-U.S. Decomposition of Labour Productivity Growth, 1987-2021")
  
skills_composition_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Skills Composition",
              align = "center") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$SC_Can) %>%
  hc_add_series(name = "USA", data = TFP$SC_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  
total_factor_productivity_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Total Factor Productivity",
              align = "center") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$TFP_Can)%>%
  hc_add_series(name = "USA", data = TFP$TFP_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_caption(
    text = "Source: Canada: Statistics Canada Table 36-10-0208-01; U.S. Bureau of Labour Statistics; ISED calculations.", style = list(fontSize = "9px")
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  

labor_growth_chart
capital_deepening_chart
skills_composition_chart
total_factor_productivity_chart
```

.pull-left[
## Weak productivity requires better use of physical & human capital

<ul style="font-size: 22px;"> 
  <li>
    Canada compares to the U.S. on the contributions of <strong>capital deepening and skills composition </strong>(e.g. level of human capital) to overall productivity growth. 

  </li>
</ul>

<ul style="font-size: 22px;"> 
  <li>
    However, Canada’s declining  relative labour productivity to the U.S. driven by weakness in <strong>total factor productivity growth,</strong> which has not improved in decades.   

  </li>
</ul>

<ul style="font-size: 22px;"> 
  <li>
    A measure of <strong>technological progress and innovation, total factor productivity </strong>shows overall effectiveness with which inputs (capital and labour) are used to produce output in an economy.
 

  </li>
</ul>
]
.pull-right[
<div class="slide-content">
<div class="text-container">
<!-- Replace this with your slide text content -->

</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=7, fig.height=2.5}
# Assuming the chart object is created and named capital_deepening_chart
labor_growth_chart
```
```{r,echo=FALSE,results='asis',fig.width=7, fig.height=2.15}
# Assuming the chart object is created and named capital_deepening_chart
capital_deepening_chart
```
```{r,echo=FALSE,results='asis',fig.width=7, fig.height=2.15}
# Assuming the chart object is created and named skills_composition_chart
skills_composition_chart
```
```{r,echo=FALSE,results='asis',fig.width=7, fig.height=2.85}
# Assuming the chart object is created and named total_factor_productivity_chart
total_factor_productivity_chart
```
</div>
</div>
]

---

```{r, echo=FALSE, include=FALSE}
IPP<-read_excel("C:/Users/davreuxa/Documents/soe/IPP.xlsx")

assign_colors <- function(values, country_names, highlight_country, color_default, color_highlight) {
  colored_values <- lapply(seq_along(values), function(i) {
    if (country_names[i] == highlight_country) {
      list(y = values[i], color = color_highlight)
    } else {
      list(y = values[i], color = color_default)
    }
  })
  return(colored_values)
}

IPP$Total_ME_IPP <- IPP$`M&E` + IPP$`IPP`
IPP <- IPP[order(IPP$`Total_ME_IPP`, decreasing = TRUE),]

# Prepare the data for "Canada" to be highlighted
m_e_colored <- assign_colors(IPP$`M&E`, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')
ipp_colored <- assign_colors(IPP$IPP, IPP$Country, "Canada", '#D7D7D7', '#FFB3AF')
non_res_colored <- assign_colors(IPP$Non_res, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')

m_e_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
  hc_subtitle(text = "M&E + IPP", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  #hc_title(text="Gross fixed capital formation by asset category (percentage of GDP, 2021)")%>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_add_series(name = "M&E", data = m_e_colored) %>%
  hc_add_series(name = "IPP", data = ipp_colored) %>%
  hc_xAxis(categories = IPP$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)%>%
  hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_yAxis(labels = list(style = list(textOverflow = "allow")))%>%
  hc_caption(text="Source: OECD.", style = list(fontSize = "9px"))

```
```{r, echo=FALSE, include=FALSE}
IPP2<-read_excel("C:/Users/davreuxa/Documents/soe/IPP.xlsx")

IPP2 <- IPP2[order(IPP2$Non_res, decreasing = TRUE),]

non_res_colored <- assign_colors(IPP2$Non_res, IPP2$Country, "Canada", '#7F7F7F', '#FE5F55')

# Generate the bar chart for Non-residential Structures with highlighted "Canada"
non_res_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
  hc_subtitle(text = "Non-residential Structures", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_add_series(name = "Non-residential Structures", data = non_res_colored) %>%
  hc_xAxis(categories = IPP2$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)%>%
  hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_yAxis(labels = list(style = list(textOverflow = "allow")))
non_res_chart
```
.center[

## More needs to be done to encourage firms to invest in productivity enhancing assets

]

.pull-left[
- <span style="font-size: 22px;"> 
<strong>It is not just an R&D story - Canadian businesses invest proportionally less </strong>in machinery & equipment (M&E)and other Intellectual Products (IPP) (e.g., software and data).
</span>
  
- <span style="font-size: 22px;">
Bank of Canada’s latest Business Outlook Survey found that many Canadian businesses are preparing to <strong>invest less in M&E </strong>over the coming year.


- <span style="font-size: 22px;">
Investing in technologies, paired with the knowledge and skills to effectively use them, <strong>contributes positively to productivity growth,<strong> supporting a healthy innovation ecosystem which is critical for economic growth. 

</span>


]
.pull-right[
<ul style="font-size: 20px;">
<center>
Gross fixed capital formation by asset category, % of GDP</ul>
</center>
.pull-left[
```{r,echo=FALSE,results='asis',fig.width=3.5, fig.height=6.235}
m_e_chart
```
]
.pull-right[
```{r,echo=FALSE,results='asis',fig.width=4, fig.height=5.85}
non_res_chart
```
]
]

---
.center[
## New sources of productivity and economic diversification required for growth
]
.pull-left[
- <span style="font-size: 22px;"> 
The <strong>largest emitting sectors </strong>of the Canadian economy (e.g. oil and gas) are also those with the <strong>highest productivity levels.</strong>

- <span style="font-size: 22px;"> 
Canadian economy is <strong>shifting from resource-dependent to service industries </strong>- the value-added share of resource-dependent industries declined from 17.2% in 2000 to 13.2% in 2019, the largest decline among G7 countries. 

- <span style="font-size: 22px;"> 
Many countries have overtaken Canada in the ability to <strong>produce diversified and complex products <strong>for international markets – export sophistication positively linked to  productivity returns. 

</span>
]


```{r, echo=FALSE, include=FALSE}
green <- read_excel("C:/Users/davreuxa/Documents/soe/green.xlsx")

green_long <- green %>% 
  pivot_longer(cols = -Date, names_to = "Country", values_to = "Value") %>%
  mutate(Date = as.character(Date)) # Convert Date to character for plotting

gchart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text="Canada's production has become less resouce heavy, but continues to be the highest within the G7",
           align = "center")%>%
  hc_subtitle(text = "GDP share of Resource-Dependant Activities, 2000 vs 2019", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_xAxis(categories = unique(green_long$Country)) %>%
  hc_yAxis(title = list(text = "%")) %>%
  hc_add_series(name = "2000", 
                data = filter(green_long, Date == "2000") %>% 
                  arrange(Country) %>% 
                  pull(Value),
                color = "#AFABAB") %>%
  hc_add_series(name = "2019", 
                data = filter(green_long, Date == "2019") %>% 
                  arrange(Country) %>% 
                  pull(Value),
                color = "#A4B9CE") %>%
  hc_legend(enabled = TRUE)%>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(text = "Source: OECD.", style = list(fontSize = "9px")) 



```
.pull-right[
```{r, echo=FALSE, fig.align='center',fig.width=7.5, fig.height=7}
gchart
```
]

---
```{r,echo=FALSE, include=FALSE}
data <- tibble(
  category = c('Labour Productivity', 'Revenue Growth', 'Employment Growth'),
  cleantech = c(14300, 13.3, 6.5),
  other = c(13500, 7.2, 2.4)
)

# Labour Productivity Chart
lp_chart <- highchart() %>%
  hc_title(text="Clean tech support vs. other innovation support, median 3 year change (2018-21)",
           align = "center")%>%
  hc_add_series(name = "Clean-tech Support", data = list(list(name = data$category[1], y = data$cleantech[1])),
                type = 'bar', color = "#CA6F07",
                tooltip = list(valueDecimals = 0, valueSuffix = 'USD')) %>%
  hc_add_series(name = "Other Innovation Support", data = list(list(name = data$category[1], y = data$other[1])),
                type = 'bar', color = "#FBC78D",
                tooltip = list(valueDecimals = 0, valueSuffix = 'USD')) %>%
  hc_subtitle(text = "Labour Productivity",
              align = "center") %>%
  hc_xAxis(categories = c(" ")) %>%
  hc_legend(enabled = TRUE)%>%
    hc_add_theme(hc_theme_bloom()) %>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )
       
# Revenue Growth Chart

rg_chart <- highchart() %>%
  hc_chart(type = 'bar') %>%
  hc_subtitle(text = "Revenue Growth",
              align = "center") %>%
  hc_xAxis(categories = c(" ")) %>%
    hc_legend(enabled = TRUE)%>%
  hc_add_series(name = "Clean-tech Support", data = c(13.3),
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_add_series(name = "Other Innovation Support", data = c(7.2),
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_plotOptions(
    series = list(
      dataLabels = list(enabled = FALSE)
    )
  ) %>%
  hc_legend(enabled = TRUE)%>%
    hc_add_theme(hc_theme_bloom())%>%
  hc_colors(colors = c('light grey',"#AFABAB"))%>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )


# Employment Growth Chart
eg_chart <- highchart() %>%
  hc_add_series(name = "Clean-tech Support", data = list(list(name = data$category[3], y = data$cleantech[3])),
                type = 'bar', color = "#263E5A",
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_add_series(name = "Other Innovation Support", data = list(list(name = data$category[3], y = data$other[3])),
                type = 'bar', color = "#A4B9CE",
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_subtitle(text = "Employment Growth",
              align = "center") %>%
  hc_xAxis(categories = c(" ")) %>%
   hc_plotOptions(
    series = list(
      dataLabels = list(enabled = FALSE)
    )
  )%>%
  hc_add_theme(hc_theme_bloom()) %>%
    hc_legend(enabled = FALSE)%>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_legend(enabled = TRUE)%>%
  hc_caption(
    text = "Source: Carta M., and Demers, F. (2023); Analysis on Federal Business Innovation and Growth Support to Clean Technology, 2016-2020.", style = list(fontSize = "9px")
  )

```

.pull-left[
## Investments in clean-tech could help to unlock new  productivity opportunities
<ul style="font-size: 22px;"> 
  <li>
Well-formulated <strong>environmental policies and programs can spur innovation, </strong>which can in turn stimulate productivity.
  </li>
 </ul>
 
<ul style="font-size: 20px;"> 
  <li>
Emerging evidence in Canada suggests that the <strong>environmental and clean technology sector </strong>is generating above-average productivity returns. 
  </li>
</ul>

<ul style="font-size: 20px;"> 
  <li>
A recent study finds that—relative to other innovation support beneficiaries—businesses getting clean-tech support: 
    <ul>
      <li>had a more educated workforce;</li>
      <li>faster labour productivity growth;</li>
      <li>faster revenue growth, and;</li>
      <li>faster employment growth compared to businesses receiving other innovation support programs. </li>
    </ul>
  </li>
</ul>
]

.pull-right[
<div class="text-container">
<!-- Your text content goes here -->
</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=3.35}
lp_chart
```
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=2.80}
rg_chart
```
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=3.20}
eg_chart
```
</div>
]

---
.center[
##Building out supply-chain necessary step to achieve shift to electric vehicles
]
.left[
<ul style="font-size: 24px;">
Rich in critical minerals, Canada lags in its processing capacity, which could increase productivity.</ul>
]
.pull-left[
- <span style="font-size: 22px;"> 
Canadian sales of <strong>EVs jumped by 30% in Q2 2023 </strong>compared to the previous quarter (see chart).

- <span style="font-size: 22px;"> 
Since 2020, Canada has secured more than <strong>$34 billion in investment in the batteries and automotive supply chain.</strong>

- <span style="font-size: 22px;"> 
However, the domestic EV supply chain is still lagging in its <strong>capacity to process the raw materials going into the battery cells.</strong>

- <span style="font-size: 22px;"> 
The <strong>U.S. Inflation Reduction Act and China’s dominant position in critical mineral processing </strong>(IMF) puts further pressure on Canada’s capability to secure its own supply chain in EV batteries.

</span>
]
```{r, echo=FALSE, include=FALSE}
ev <- read_excel("C:/Users/davreuxa/Documents/soe/ev.xlsx")


ev_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text="EV sales numbers have been soaring in the past two quarters", 
           style = list(fontSize = "19px"),
           align = "center")%>%
  hc_subtitle(text = "EV registrations (left) vs. share of total vehicle sales(right)", 
              style = list(fontSize = "16px"),
              align = "center") %>%
  hc_xAxis(categories = ev$quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "thousands"),
      opposite = FALSE,
      min=0,
      max=60
      ),
    list(
      title = list(text = "%"), 
      opposite = TRUE
      )
  ) %>%
  hc_add_series(name = "Battery electric", data = ev$battery_electric, type = "column", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = 'k')) %>%
  hc_add_series(name = "Plug-in hybrid electric", data = ev$plugin_hybrid, type = "column", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = 'k')) %>%
  hc_add_series(name = "Share of Sales", data = ev$share_of_sales, type = "line", yAxis = 1, marker = list(enabled = TRUE),
                tooltip = list(valueDecimals = 2, valueSuffix = '%')) %>%
  hc_plotOptions(column = list(stacking = 'normal')) %>%
  hc_legend(enabled = TRUE) %>%
  hc_credits(enabled = FALSE)%>%
  hc_colors(colors = c("#A4B9CE","#AFABAB", "grey")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_caption(
    text = "Source: Statistics Canada. Table 20-10-0024-01. New motor vehicle registrations, quarterly.", style = list(fontSize = "8px")
  )


```

.pull-right[

```{r,echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.75}
ev_chart
```
]

---
.center[
##Tech adoption in Canada continues to lag
]

.pull-left[
- <span style="font-size: 22px;"> 
Digital-intensive sectors, associated with significant <strong>productivity gains, </strong>accounted for 6% of Canada’s GDP in 2020, lagging most G7 peers (see chart).

- <span style="font-size: 22px;"> 
<strong>Small-Medium Sized firms (SMEs),</strong> the majority of Canadian economy, <strong>continue to lag larger firms in the use of foundational technologies</strong> (e.g., e-commerce). 


- <span style="font-size: 22px;"> 
Canada’s skilled workforce and early <strong>investment in AI </strong>technologies can facilitate a better integration of digital tools in its economy.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.align='center',fig.width=7.5, fig.height=7}
DII <- read_excel("C:/Users/davreuxa/Documents/soe/DII.xlsx")

dii_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Contribution to value added growth by digital intensity sectors",
           align = "center") %>%
  hc_xAxis(categories = DII$Country) %>%
hc_yAxis(
    title = list(text = "%"),
    min = -5, # Set the minimum bound
    max = 100  # Set the maximum bound
  ) %>%
  hc_plotOptions(column = list(stacking = 'normal')) %>%
  hc_add_series(name = "High digital-intensive industries", data = DII$`High digital-intensive industries`, color = "#0E3A55") %>%
  hc_add_series(name = "Medium-high digital-intensive industries", data = DII$`Medium-high digital-intensive industries`, color = "#B7D7E2") %>%
  hc_add_series(name = "Medium-low digital-intensive industries", data = DII$`Medium-low digital-intensive industries`, color = "#DCD3CC") %>%
  hc_add_series(name = "Low digital-intensive industries", data = DII$`Low digital-intensive industries`, color = "#FE5F55") %>%
  #hc_add_series(name = "Annual real value added growth", data = DII$`Annual real value added growth`, color = "#1aadce", type = "scatter", 
                #marker = list(lineWidth = 2, lineColor = "black", fillColor = "white"), 
                #dataLabels = list(enabled = TRUE, format = '{point.y:.2f}%', style = list(fontSize = '13px'))) %>%
  hc_legend(enabled = TRUE) %>%
  hc_credits(enabled = FALSE)%>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared=TRUE
  ) %>%
  hc_caption(
    text = "Source: Digitally Intensive Sectors determined using methodology by Calvino et al (2018); data from the OECD", style = list(fontSize = "9px")
  )


# Print the chart
dii_chart
```
]

---
.center[
##Labour market tightness remains elevated
]
<ul style="font-size: 24px;">
Labour shortages can be good news for productivity.</ul>

.pull-left[

- <span style="font-size: 22px;"> 
<strong>Job vacancies declined to 632,200 </strong>in September 2023. but remain well above pre-COVID levels.


- <span style="font-size: 22px;"> 
Top three sectors with the <strong>highest vacancies </strong>(e.g. accommodation and food services, health care and social assistance, and construction) represent 16.5% of Canada’s GDP. 


- <span style="font-size: 22px;"> 
To <strong>mitigate the negative effects of labour shortages,</strong> businesses may need to adopt strategies such as investing in workforce development, improving workplace conditions, and exploring technological solutions to automate certain tasks.

</span>
]
```{r, echo=FALSE, include=FALSE}
vacancy <- read_excel("C:/Users/davreuxa/Documents/soe/vacancy.xlsx")

vacancy_graph <-highchart() %>%
  hc_chart(type = "line") %>%
  hc_title(text = "Vacancies continue to decline as the number of available worker per open position nearly doubles since last year.",
           align = "center") %>%
  hc_xAxis(categories = format(as.Date(vacancy$Date), "%b %y")) %>%  
  hc_yAxis_multiples(
    list(title = list(text = " ")),
    list(title = list(text = " "), opposite = TRUE)
  ) %>%
 hc_add_series(name = "Unemployment-to-job Vacancies", data = vacancy$unemp, type = "line", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = '%')) %>%
  hc_add_series(name = "Job vacancies", data = vacancy$vacancy, type = "line", yAxis = 1,
                tooltip = list(valueDecimals = 0, valueSuffix = ' ')) %>% 
  hc_legend(enabled = FALSE) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c("#A4B9CE","#AFABAB")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Statistics Canada. Labour force characteristics and job vacancies.", style = list(fontSize = "9px")
  ) %>%
  hc_subtitle(text="Unemployment-to-job vacancy ratio (left) and job vacancies (right), monthly", 
              style = list(fontSize = "16px"),
              align = "center")
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.55}
vacancy_graph
```
]

---
.pull-left[
## Summary
<img src="policy.jpg" width="85%"/>
]

- <span style="font-size: 25px;"> 
Economic headwinds likely to result in slower economic activity in the near-term. <strong>ISED policies and programs to prepare for different economic downturn scenarios within a tight fiscal environment. </strong>


- <span style="font-size: 25px;"> 
<strong>Elevated interest rates and ongoing significant affordability challenges continue to weigh on Canadian households, </strong>consumers and businesses, with recent drops in productivity effectively erasing five years of gains. ISED to continue looking at how various policy levers can be deployed to help solve the productivity puzzle.  


- <span style="font-size: 25px;"> 
Low investment in R&D and innovation-enhancing activities also expected to weigh on economic growth. <strong>ISED policies to  continue to seek to accelerate innovation,</strong> including technology adoption and intangible assets, lifting productivity growth.


</span>
---
.pull-left[
##For more information

]

<img src="hub.png" width="70%"/>

 <span style="font-size: 25px;"> 
SRRB has launched a new website: <strong>[Economic Policy Research Hub](https://033gc.sharepoint.com/sites/EconomicResearchandAnalysisERA/SitePages/Home%20Page.aspx?from=SendByEmail&e=wAEAyo9qXE20Vlezw85pIw&at=9) </strong> where users can access the latest micro-economic analysis on key trends shaping the Canadian economy such as innovation, competitiveness, trade, human capital, and productivity. 

<span style="font-size: 25px;"> 
Note that the hub is also available through the homepage of <strong>[ISEDWeb](https://033gc.sharepoint.com/sites/EconomicResearchandAnalysisERA/SitePages/Home%20Page.aspx?from=SendByEmail&e=wAEAyo9qXE20Vlezw85pIw&at=9).</strong>


