---
title: "The State of the Canadian Economy"
author: "Presentation to DGPC"
date: "January 16, 2024"
output:
  xaringan::moon_reader:
    self_contained: true
    css: [default,hygge-duke,chocolate-fonts]
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
class: middle, center, title-slide-background
background-size: contain
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
```

```{r, echo=FALSE, include=FALSE}
library(OECD)
library(rmarkdown)
library(tidyverse)
library(forecast)
library(xts)
library(rmarkdown)
library(openxlsx)
library(XML)
library(reshape2)
library(plyr)
library(ggplot2)
library(rCharts)
library(dplyr)
library(tidyr)
library(ggcharts)
library(ggpol)
library(RColorBrewer)
library(highcharter)
library(vtable)
library(webshot)
library(scales)
library(statcanR)
library(tidyverse)
library(writexl)
library(highcharter)  # Make sure you have the highcharter library installed
library(readxl)
```

.left[
## Key Messages
.pull-left[
- <span style="font-size: 22px;"> 
Higher interest rates will continue to weigh on economic activity. While a soft landing is within reach, <strong>Canadian consumers and businesses are under pressure </strong>from rising costs, which could limit growth prospects in 2024.

- <span style = "font-size:22px;">
Tackling weak productivity growth in Canada remains a critical economic challenge. The <strong>twin transitions of green and digital present opportunities to unlock new productivity avenues</strong>.

- <span style = "font-size:22px;">
<strong>Sub-optimal business investment</strong> should continue to <strong>raise alarm bells </strong>as it is a key factor for higher incomes and living standards in Canada
</span>
]
]

.pull-right[
<img src = "keymessages.jpg" width = "90%"/>
]
---
<center>
<img src = "recentdev.jpg" width = "80%"/>
</center>

---

```{r Econ dashboard called Test, include=FALSE, echo=FALSE}

# Data similar to the one in the image uploaded
data <- data.frame(
  categories = c("Monthly GDP", "Inflation", "Interest Rate", "Unemployment",
                 "Business Confidence Index", "Consumer Confidence Index", 
                 "Exports Growth", "Business Investment", "Business Insolvencies"),
  values = c(0.1, -3.1, -5, 5.8, -3.4, 3.7, 2.2, 2.4, 3.5), # Mock values
  periods = c("Sept.", "Oct.", "Nov.", "Nov.", "Nov.", "Nov.", "Oct.", "Q2 2023", "Q3 2023"),
  colors = c("#FF0000", "#FF0000", "#FF0000", "#FF0000",  # Red for first 4
             "#7a9e9f", "#7a9e9f",                        # Teal for next 2
             "#FFD700", "#FFD700", "#FFD700")             # Yellow for last 3
)

# Parse the data for highcharter
data_list <- lapply(1:nrow(data), function(i) {
  list(
    name = data$categories[i],
    y = data$values[i],
    color = data$colors[i]
  )
})

# Create the highchart object with customized colors
test<-highchart() %>%
  hc_chart(type = 'column') %>%
  #hc_title(text = "Economic Dashboard") %>%
  #hc_subtitle(text = "Growth comes to a halt as higher rates start to impact businesses and labor") %>%
  hc_xAxis(categories = data$categories) %>%
  hc_yAxis(title = list(text = "Monthly Percentage Change")) %>%
  hc_add_series(name = "Economic Indicators", data = data_list, dataLabels = list(enabled = TRUE)) %>%
  hc_tooltip(formatter = JS("function() { return this.x + ': <b>' + this.y + '%</b> '; }")) %>%
  hc_plotOptions(series = list(
    dataLabels = list(enabled = TRUE, format = '{y:.1f}%')
  ))

```

###Growth comes to a halt as higher rates start to impact businesses and labor

```{r, echo=FALSE, out.width='100%', include=FALSE, fig.align='center', class='centered-plot'}
test
```
<center>
<img src = "dashboard.jpg" width = "190%"/>
</center>

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> <strong>Economic dashboard</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>
---
### Monetary policy tightening is starting to impact growth
#### GDP contracted by 0.3% in the third quarter as the effects of higher interest rates trickle through the economy 

.pull-left[
- <span style="font-size: 22px;"> 
Canada's economy shrank in the three months up to September, as business investments and exports declined while consumer spending remained flat.

- <span style="font-size: 22px;"> 
The effects of interest rate increases will continue to restrain spending, while limiting growth and employment (see Annex A). 

- <span style="font-size: 22px;"> 
Recent private sector forecasts project either <strong>weak or negative growth over the next two quarters</strong> (see Annex B). 

</span>
]


```{r, echo=FALSE}
monetary <- read_excel("C:/Users/davreuxa/Documents/soe/monetary.xlsx")

monetary1<- monetary %>%
  pivot_longer(-indicator, names_to = "Quarter", values_to = "Value")%>%
  pivot_wider(names_from = `indicator`, values_from = `Value`)

monetary_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = monetary1$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "GDP Quarterly Growth"),
      opposite = FALSE
    ),
    list(
      title = list(text = "Bank of Canada Policy Interest Rate"),
      opposite = TRUE
    )
  ) %>%
  hc_add_series(
    name = "GDP quarterly growth",
    data = monetary1$`GDP Quarterly Growth`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_plotOptions(
    column = list(
      colorByPoint = TRUE,
      colors = ifelse(monetary1$`GDP Quarterly Growth` < 0, "#E31737", "#333F50")
    )
  ) %>%
  hc_add_series(
    name = "Bank of Canada Policy Interest Rate",
    data = monetary1$`Bank of Canada Policy Interest Rate`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Statistics Canada, Table 36-10-0434-01; Gross domestic product (GDP) at basic prices, by industry, monthly (x 1,000,000), Bank of Canada, target for the overnight rate"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6}
monetary_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic dashboard</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Monetary policy</strong></span>
  <span class="small-font" style="margin-left: 100px;">Looking ahead</span>
</div>

---
###What's the economic outlook?
#### The Canadian economy is expected to continueits slowdown through the first half of 2024, while economic activity should improve in the second half of the year.
.pull-left[
- <span style="font-size: 22px;"> 
High interest rates are expected to <strong>dampen business investments </strong> while weaker global demand could reduce exports, causing Canadaâ€™s forecasted growth in 2023 and 2024 to be weaker than previously projected.


- <span style="font-size: 22px;"> 
Currently at 5.8% (November 2023), the <strong>unemployment rate is expected to gradually increase to 6.5% by the end of 2024 </strong>as slower hiring rates will continue to cool down a tight labor market.


</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
proj<-highchart() %>%
  hc_chart(type = "line") %>%
  hc_title(text = "Real GDP growth, past and projected, for selected countries and the world, yearly, percentage ") %>%
  hc_xAxis(categories = c(2022, 2023, 2024, 2025),
           plotBands = list(
             list(
               from = 0.5,  # Assuming the categories are zero-indexed
               to = 3.5,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = "GDP Growth (%)")) %>%
  hc_add_series(name = "Canada, previous projection", data = c(3.4, 1.8, 1.2, 2.4)) %>%
  hc_add_series(name = "Canada, current projection", data = c(3.4, 1.2, 0.9, 2.5)) %>%
  hc_add_series(name = "World, current projection", data = c(3.4, 2.9, 2.3, 2.6)) %>%
  hc_add_series(name = "World, previous projection", data = c(3.4, 2.8, 2.4, 2.7)) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c('#FFBBAB', '#FF0000', 'black', 'grey')) %>%
  hc_add_theme(hc_theme_bloom()) 


```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6}
proj
```
]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Looking ahead</strong></span>
</div>
---
<center>
<img src = "currenthead.jpg" width = "70%"/>
</center>
---
### Elevated public and private debt levels will dampen opportunities for investment 

.pull-left[
#### Fiscal capacity is constrained
- <span style="font-size: 17px;"> 
Current federal debt is about 42 per cent of GDP. The government has pledged to run deficits no larger than 1% of GDP (fiscal anchor).
```{r, echo=FALSE, fig.width=6, fig.height=5.5}
feddebt <- read_excel("C:/Users/davreuxa/Documents/soe/feddebttogdp.xlsx")


feddebt_graph <-highchart() %>%
  hc_chart(type = "line") %>%
  hc_title(text = "Federal Debt-to-GDP ratio") %>%
  hc_xAxis(categories = feddebt$Date,
           plotBands = list(
             list(
               from = 7,  # Assuming the categories are zero-indexed
               to = 13,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = "actual and forecasted values (%)")) %>%
  hc_add_series(name = "Canada, previous projection", data = feddebt$`Federal debt to GDP`) %>%
  hc_add_series(name = "Canada, current projection", data = feddebt$Forecast) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = FALSE, crosshairs = TRUE)%>%
  hc_colors(colors = c("grey", "#A4B9CE")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Fall Economic Statement 2023"
  ) 

feddebt_graph
```

]
.pull-right[
#### Corporate debt has reached record levels
- <span style="font-size: 17px;"> 
Interest charges reached $22.9 billion in Q3 2023 while banks are bracing for higher insolvencies (see Annex C).
```{r, echo=FALSE, fig.width=7, fig.height=6}
corpdebt <- read_excel("C:/Users/davreuxa/Documents/soe/corpdebt.xlsx")

corpdebt_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_title(text = "Total debt of non-financial corporations(left, and interest rate chargers(right)") %>%
  hc_xAxis(categories = corpdebt$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "$ billion"),
      opposite = FALSE
    ),
    list(
      title = list(text = "%"),
      opposite = TRUE
    )
  ) %>%
  hc_add_series(
    name = "Total debt of non-financial corporations",
    data = corpdebt$`Total debt of non-financial corporations (left)`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_add_series(
    name = "Interest rate charges",
    data = corpdebt$`Interest charges (right)`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Quarterly balance sheet, income statement, and selected financial ratios, by non-financial industries, non-seasonally adjusted (billions)."
  ) %>%
  hc_colors(colors = c("grey", "#A4B9CE")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )

corpdebt_chart
```

]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> <strong>Wage-Price Spiral Risks</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Price of intrants </span>
  <span class="small-font" style="margin-left: 100px;">Corporate debt and insolvencies</span>
</div>
---
### Canadian households are under pressure
#### Affordibility remains a key issue, creating a drag on consumption. 
.pull-left[
- <span style="font-size: 22px;"> 
<strong>High demand from population growth and a lack of supply </strong>in the housing market have offset gains in household income.

- <span style="font-size: 22px;"> 
The Bank of Canadaâ€™s <strong>housing affordability index reached its highest level </strong>â€” meaning the worst degree of affordability â€” since 1982.

- <span style="font-size: 22px;"> 
Households are allocating a higher portion of their income to housing, using up more than 38% in 2022, a 4% increase compared to 2019.

- <span style="font-size: 22px;"> 
The average household is spending around 15 cents of every after-tax dollar to service their debt â€“ the highest since 1990.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.width=8, fig.height=6}
housecost <- read_excel("C:/Users/davreuxa/Documents/soe/housecost.xlsx")

housecost_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = housecost$Date) %>%
  hc_add_series(
    name = "Housing affordability index, quarterly",
    data = housecost$`Value`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%"),
    plotLines = list(
      list(
        color = '#446992',          # Color of the dashed line
        width = 2,              # Width of the line
        dashStyle = 'Dash',     # Style of the line
        value = 0.55,           # The y-value where the dashed line is drawn
        zIndex = 5,             # Ensures that the line is above the plot
        label = list(
          text = 'Highest level in 41 years',
          align = 'right',
          style = list(
            color = '#446992'
          )
        )
      )
    )
  ) %>%
  hc_caption(
    text = "Source: Bank of Canada, Housing Affordibility."
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Housing costs are taking an ever increasing share of households' income") %>%
  hc_colors(colors = c("grey", "#A4B9CE"))

# To display the chart if you're running this in an interactive R session
housecost_chart
```
]
---
### Inflationary pressures might be easing
#### Recent inflation numbers are the lastest sign of a cooling economy 
.pull-left[
- <span style="font-size: 22px;"> 
Canada's <strong> consumer price index rose by 3.1% </strong> in the year up to October, down from 3.8% the rpevious month. 

- <span style="font-size: 22px;"> 
Overall, <strong>shelter costs (e.g. mortgage and rent payments) are up by more than six% </strong> in the past year. That's about twice the overall inflation rate.

- <span style="font-size: 22px;"> 
<strong>CPI â€“ food purchased from stores was 5.6%.</strong> Grocery prices have now decelerated for four months in a row.

- <span style="font-size: 22px;"> 
Historical experience suggests that the recent easing of cost pressures in production and distribution (see Annex A) will lead to <strong>further declines in food price inflation </strong>over the coming months.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.width=8, fig.height=6}
foodinf <- read_excel("C:/Users/davreuxa/Documents/soe/foodinf.xlsx")

foodinf_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = format(as.Date(foodinf$Date), "%b %y")) %>%
  hc_add_series(
    name = "Food Inflation",
    data = foodinf$`Food Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "Headline Inflation",
    data = foodinf$`Headline Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "Year-over-year inflation, monthly(%)")
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Table 18-10-0006-01 Consumer Price Index, monthly"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Food inflation continues to decrease from its January 2023 peak, getting closer to the all-items inflation") %>%
  hc_colors(colors = c("grey", "#A4B9CE"))

# To display the chart if you're running this in an interactive R session


foodinf_chart
```
]

---
###Wages are finally catching up with inflation, adding cost pressure on firms

.pull-left[
- <span style="font-size: 22px;"> 
Workers have seen their average wages rise at the same rate as inflation in 2023 (+3.0% up to September)

- <span style="font-size: 22px;"> 
From the firmâ€™s perspective, the cost of labor has been rising faster than the increase in price of the products sold for the last four quarters

- <span style="font-size: 22px;"> 
On a sectoral basis, wages in the service-producing industries have been growing faster than inflation in 2023, resulting in positive real wage growth (+0.6%), while those in the goods-producing industries are trailing behind (-0.8%) (up to September)

</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6, warning=FALSE}
cons <- read_excel("C:/Users/davreuxa/Documents/soe/construction.xlsx")



const <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = cons$Quarter) %>%
  hc_add_series(
    name = "Change in the cost of labor",
    data = cons$`Change in the cost of labor`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
    hc_add_series(
    name = "Change in the price of goods sold",
    data = cons$`Change in the price of goods sold`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0206-01 Indexes of business sector labour productivity, unit labour cost and related measures, seasonally adjusted"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_title(text = "Quarterly change in the unit labor cost, and the implicit price deflator, percentage")%>%
  hc_colors(colors = c("grey", "#A4B9CE"))

```

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=6}
const
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> <strong>Wage-Price Spiral Risks</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Price of intrants </span>
  <span class="small-font" style="margin-left: 100px;">Corporate debt and insolvencies</span>
</div>
---
###Tackling weak productivity growth is critical
#### Canadaâ€™s productivity has dipped below pre-pandemic levels while widening the gap with the US
.pull-left[
- <span style="font-size: 22px;"> 
Wage increases would be <strong>non-inflationary with higher productivity </strong> but that is not the case in Canada. 

- <span style="font-size: 22px;"> 
<strong>Canada needs to alter its current productivity course</strong> or be destined to enter an era of reduced consumption and declining living standards.

- <span style="font-size: 22px;"> 
Over the past four years, <strong>output per hour in the business sector has dropped at a 0.2% annual rate</strong>, the first negative reading on record over such a sustained period, whereas it has increased by 1.4% in the US (see chart). 
</span>
]
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7, fig.height=6}
LP <- read_excel("C:/Users/davreuxa/Documents/soe/LP.xlsx")

lp_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = LP$Quarter) %>%
  hc_add_series(
    name = "Canada",
    data = LP$Canada,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "US",
    data = LP$US,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "Year-over-year inflation, monthly(%)")
  ) %>%
  hc_caption(
    text = "Source:Statistics Canada, US Federal Reserve Economic Data"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Labour productivity in the business sector, Canada vs. US, annualized 4-year change (%)") %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))

lp_chart
```
]
---
<center>
<img src = "blueprint.jpg" width = "60%"/>
</center>
---

```{r, echo=FALSE,  include=FALSE}
TFP <- read_excel("C:/Users/davreuxa/Documents/soe/TFP.xlsx")

multiplier <- 100

# Apply the multiplier to all columns except 'Date'
TFP[, -which(names(TFP) == "Date")] <- TFP[, -which(names(TFP) == "Date")] * multiplier


labor_growth_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Labour Productivity Growth") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$LP_Can)%>%
  hc_add_series(name = "USA", data = TFP$LP_US) %>%
   hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))


capital_deepening_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Capital Deepening") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$CD_Can)%>%
  hc_add_series(name = "USA", data = TFP$CD_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  
skills_composition_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Skills Composition") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$SC_Can) %>%
  hc_add_series(name = "USA", data = TFP$SC_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  
total_factor_productivity_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Total Factor Productivity") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$TFP_Can)%>%
  hc_add_series(name = "USA", data = TFP$TFP_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_caption(
    text = "Source: Canada: Statistics Canada Table 36-10-0208-01; U.S.: U.S. Bureau of Labour Statistics, ISED calculations."
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  

labor_growth_chart
capital_deepening_chart
skills_composition_chart
total_factor_productivity_chart
```

.pull-left[
###Canada's weak productivity growth requires firms to make better use of physical and human capital

<ul style="font-size: 20px;"> 
  <li>
    Labour productivity rises through:
    <ul>
      <li>More structures, machines, and intangible assets <strong>(capital deepening)</strong>.</li>
      <li>More skills <strong>(skill composition of labour force)</strong>.</li>
      <li>More effective use of the above inputs <strong>(total factor productivity)</strong>.</li>
    </ul>
  </li>
 </ul>
 
<ul style="font-size: 20px;"> 
  <li>
    Canadaâ€™s lower relative labour productivity is driven by weakness in <strong>total factor productivity growth</strong>, which has not improved in decades.
  </li>
</ul>

<ul style="font-size: 20px;"> 
  <li>
    <strong>Total factor productivity</strong> is a measure of overall effectiveness with which inputs (capital and labour) are used to produce output in an economy. It is a <strong>measure of technological progress and innovation.</strong>
  </li>
</ul>


]
.pull-right[
<div class="slide-content">
<div class="text-container">
<!-- Replace this with your slide text content -->
<center>
 Canada-U.S. Decomposition of Labour Productivity Growth, 1987-2021
</center>
</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=2.75}
# Assuming the chart object is created and named capital_deepening_chart
capital_deepening_chart
```
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=2.5}
# Assuming the chart object is created and named skills_composition_chart
skills_composition_chart
```
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=3}
# Assuming the chart object is created and named total_factor_productivity_chart
total_factor_productivity_chart
```
</div>
</div>
]
---
```{r, echo=FALSE, include=FALSE}
IPP <- read_excel("C:/Users/davreuxa/Documents/soe/IPP.xlsx")
assign_colors <- function(values, country_names, highlight_country, color_default, color_highlight) {
  colored_values <- lapply(seq_along(values), function(i) {
    if (country_names[i] == highlight_country) {
      list(y = values[i], color = color_highlight)
    } else {
      list(y = values[i], color = color_default)
    }
  })
  return(colored_values)
}

# Prepare the data for "Canada" to be highlighted
m_e_colored <- assign_colors(IPP$`M&E`, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')
ipp_colored <- assign_colors(IPP$IPP, IPP$Country, "Canada", '#D7D7D7', '#FFB3AF')
non_res_colored <- assign_colors(IPP$Non_res, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')

# Generate the stacked bar chart for M&E and IPP with highlighted "Canada"
m_e_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
  hc_title(text = "Machinery & Equipment + Intellectual Property Products") %>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_add_series(name = "M&E", data = m_e_colored) %>%
  hc_add_series(name = "IPP", data = ipp_colored) %>%
  hc_xAxis(categories = IPP$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)

# Generate the bar chart for Non-residential Structures with highlighted "Canada"
non_res_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
    hc_title(text = "Non-residential Structures") %>%
  hc_add_series(name = "Non-residential Structures", data = non_res_colored) %>%
  hc_xAxis(categories = IPP$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)
```

.pull-right[
<div class="text-container">
<!-- Your text content goes here -->
<center>
Gross fixed capital formation by asset category (percentage of GDP, 2021)
</center>
</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=4.25}
m_e_chart
```
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=4.25}
non_res_chart
```

</div>
]
---
### Business insolvency rates have surpassed pre-pandemic levels for the vast majority of industries

.pull-left[
-Non-financial corporations continue to borrow more, increasing their total debt by **1.5% in Q3 2023** and their interest expenses are rapidly increasing, reaching their highest recorded value of $22.8 billion


-As of August 2023, most industries had a higher business insolvency rate compared to pre-pandemic, with the notable exception of information and cultural industries and construction


-Tourism-related industries, energy and manufacturing have the highest insolvency rates and are trending up



]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6, warning=FALSE}
debt <- read_excel("C:/Users/davreuxa/Documents/soe/debt.xlsx")



debt1 <- highchart() %>%
  hc_chart(type = "bar", zoomType = "xy") %>%
  hc_xAxis(categories = debt$`Industry`) %>%
  hc_add_series(
    name = "Jan-Aug2023",
    data = debt$`Jan-Aug 2023`
  ) %>%
    hc_add_series(
    name = "Jan-Aug2019",
    data = debt$`Jan-Aug 2019`
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0104-01"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_title(text = "Quarterly change in the unit labor cost, and the implicit price deflator, percentage")%>%
  hc_colors(colors = c( "#7a9e9f","#b8d8d8"))


```

.pull-right[
```{r, echo=FALSE, warning=FALSE}
debt1
```

]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #7A9E9F; text-align: center;">
 <span class="small-font"> Wage-Price Spiral Risks</span> 
  <span class="small-font" style="margin-left: 100px;">Price of intrants </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Corporate debt and insolvencies</strong></span>
</div>
---


<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #7A9E9F; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Sector snapshot</strong></span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>

---
class: inverse



.left[
##A Policy Agenda
.pull-left[
<img src="vic.jpg" width="100%"/>
]
]

.pull-right[
- <span style="font-size: 32px;"> 
BERD
</span>
  
- <span style="font-size: 32px;">
REGIONAL PRODUCTIVITY
</span>

- <span style="font-size: 32px;">
TRADE RESTRICTIONS 
</span>

- <span style="font-size: 32px;">
LAG IN CONSTRUCTION
</span>

- <span style="font-size: 32px;">
INVESTMENTS IN BATTERIES
</span>

- <span style="font-size: 32px;">
CRITICAL MINERALS
</span>
]

---
###Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels
```{r, echo=FALSE, include=FALSE}

# Create a data frame with the GDP growth information
gdp_growth <- data.frame(
  Industry = c(
    "Professional services", "Public administration", "Finance and insurance", 
    "Health care and social assistance", "Educational services", "Real estate and rental and leasing", 
    "Retail trade", "Information and cultural industries", "Other services", "Wholesale trade", 
    "Energy and mining", "Manufacturing", "Construction", "Transportation and warehousing", 
    "Utilities", "Administrative and support", "Accommodation and food services", 
    "Agriculture, forestry, fishing and hunting", "Arts, entertainment and recreation"
  ),
  RelativeToPrePandemic = c(
    11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -0.2, -2.4, 
    -4.1, -5.3, -7.0, -8.9, -7.3
  ),
  PastYear = c(
    1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -0.7, 4.5, 
    -6.4, 0.1, 0.0, -15.7, 7.4
  ),
  PastThreeMonths = c(
    -0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, 
    -2.2, -0.6, -1.0, 1.0, -7.5
  )
)

# Create the Highchart
sect<-highchart() %>%
  hc_chart(type = "bar") %>%
  hc_title(text = "Sector Snapshot") %>%
  hc_subtitle(text = "Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels") %>%
  hc_xAxis(categories = gdp_growth$Industry) %>%
  hc_yAxis(title = list(text = "GDP growth (%)")) %>%
  hc_add_series(name = "Relative to pre-pandemic", data = gdp_growth$RelativeToPrePandemic) %>%
  hc_add_series(name = "Past year", data = gdp_growth$PastYear) %>%
  hc_add_series(name = "Past three months", data = gdp_growth$PastThreeMonths) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_tooltip(pointFormat = "<span style='color:{point.color}'>\u25CF</span> {series.name}: <b>{point.y}%</b><br/>")

sect

```
```{r,echo=FALSE}
industries <- c("Professional services", "Public administration", "Finance and insurance",
                "Health care and social assistance", "Educational services",
                "Real estate and rental and leasing", "Retail trade",
                "Information and cultural industries", "Other services", "Wholesale trade",
                "Energy and mining", "Manufacturing", "Construction",
                "Transportation and warehousing", "Utilities", "Administrative and support",
                "Accommodation and food services", "Agriculture, forestry, fishing and hunting",
                "Arts, entertainment and recreation")

pre_pandemic <- c(11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -1.2, -2.4, -4.1, -5.3, -7.0, -7.3, -8.9)
past_year <- c(1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -1.7, 4.5, -6.4, 0.1, 0.0, -15.7, 7.4)
past_three_months <- c(-0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, -2.2, -0.6, -1.0, 1.0, -7.5)

# Create a list of lists for highcharter
data_for_chart <- list(
  list(name = 'Relative to pre-pandemic', data = pre_pandemic),
  list(name = 'Past year', data = past_year),
  list(name = 'Past three months', data = past_three_months)
)

# Create the Highchart
sect2<-highchart() %>%
  hc_chart(type = 'bar') %>%
  hc_title(text = "GDP growth by industry, as of August 2023, percentage") %>%
  hc_xAxis(categories = industries) %>%
  hc_yAxis(title = list(text = "Growth (%)")) %>%
  hc_add_series_list(data_for_chart) %>%
  hc_plotOptions(series = list(stacking = 'normal')) %>%
  hc_legend(reversed = TRUE) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE) 
  #hc_exporting(enabled = TRUE) # Enable chart exporting (optional)

```
<center>
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
sect2
```
</center>


---
class: inverse
