---
title: "The State of the Canadian Economy"
author: "Presentation to DGPC"
date: "January 16, 2024"
output:
  xaringan::moon_reader:
    self_contained: true
    css: [default,hygge-duke,chocolate-fonts]
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
class: middle, center, title-slide-background
background-size: contain
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
```

```{r, echo=FALSE}
install.packages("OECD")
install.packages("statcanR")
install.packages("devtools")
install.packages("forecast")
install.packages("xts")
install.packages("rmarkdown")
install.packages("openxlsx")
devtools::install_github('warint/statcanR')
remotes::install_github("jbkunst/highcharter")
install.packages("RColorBrewer")
install.packages("gridExtra")
install.packages("XML")
install.packages("reshape2")
install.packages("plyr")
install.packages("ggplot2")
install.packages("devtools")
devtools::install_github("ramnathv/rCharts")
install.packages("vtable")
install.packages("htmlwidgets")
webshot::install_phantomjs()
install.packages("scales")
install.packages("statcanR")
install.packages("writexl")
install.packages("rmdformats")
```
```{r, echo=FALSE}
library(OECD)
library(rmarkdown)
library(tidyverse)
library(forecast)
library(xts)
library(rmarkdown)
library(openxlsx)
library(XML)
library(reshape2)
library(plyr)
library(ggplot2)
library(rCharts)
library(dplyr)
library(tidyr)
library(ggcharts)
library(ggpol)
library(RColorBrewer)
library(highcharter)
library(vtable)
library(webshot)
library(scales)
library(statcanR)
library(tidyverse)
library(writexl)
library(highcharter)  # Make sure you have the highcharter library installed
library(readxl)
```

.left[
## Key Messages
.pull-left[
- <span style="font-size: 22px;"> 
Higher interest rates will continue to weigh on economic activity. While a soft landing is within reach, <strong>Canadian consumers and businesses are under pressure </strong>from rising costs, which could limit growth prospects in 2024.

- <span style = "font-size:22px;">
Tackling weak productivity growth in Canada remains a critical economic challenge. The <strong>twin transitions of green and digital present opportunities to unlock new productivity avenues</strong>.

- <span style = "font-size:22px;">
<strong>Sub-optimal business investment</strong> should continue to <strong>raise alarm bells </strong>as it is a key factor for higher incomes and living standards in Canada
</span>
]
]

.pull-right[
<img src = "keymessages.jpg" width = "90%" height = "150%"/>
]
---
<center>
<img src = "recentdev.jpg" width = "70%"/>
</center>

---

```{r Econ dashboard called Test, include=FALSE, echo=FALSE}

# Data similar to the one in the image uploaded
data <- data.frame(
  categories = c("Monthly GDP", "Inflation", "Interest Rate", "Unemployment",
                 "Business Confidence Index", "Consumer Confidence Index", 
                 "Exports Growth", "Business Investment", "Business Insolvencies"),
  values = c(0.1, -3.1, -5, 5.8, -3.4, 3.7, 2.2, 2.4, 3.5), # Mock values
  periods = c("Sept.", "Oct.", "Nov.", "Nov.", "Nov.", "Nov.", "Oct.", "Q2 2023", "Q3 2023"),
  colors = c("#FF0000", "#FF0000", "#FF0000", "#FF0000",  # Red for first 4
             "#7a9e9f", "#7a9e9f",                        # Teal for next 2
             "#FFD700", "#FFD700", "#FFD700")             # Yellow for last 3
)

# Parse the data for highcharter
data_list <- lapply(1:nrow(data), function(i) {
  list(
    name = data$categories[i],
    y = data$values[i],
    color = data$colors[i]
  )
})

# Create the highchart object with customized colors
test<-highchart() %>%
  hc_chart(type = 'column') %>%
  #hc_title(text = "Economic Dashboard") %>%
  #hc_subtitle(text = "Growth comes to a halt as higher rates start to impact businesses and labor") %>%
  hc_xAxis(categories = data$categories) %>%
  hc_yAxis(title = list(text = "Monthly Percentage Change")) %>%
  hc_add_series(name = "Economic Indicators", data = data_list, dataLabels = list(enabled = TRUE)) %>%
  hc_tooltip(formatter = JS("function() { return this.x + ': <b>' + this.y + '%</b> '; }")) %>%
  hc_plotOptions(series = list(
    dataLabels = list(enabled = TRUE, format = '{y:.1f}%')
  ))

```
.center[
##Growth comes to a halt as higher rates start to impact businesses and labour
]

<center>
<img src = "dashboard.jpg" width = "190%"/>
</center>

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> <strong>Economic dashboard</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;">Standard of Living</span>
</div>
---
.center[
## Monetary policy tightening is starting to impact growth
]

#### GDP contracted by 0.3% in the third quarter as the effects of higher interest rates trickle through the economy 

.pull-left[
- <span style="font-size: 22px;"> 
Canada's economy shrank in the three months up to September, as <strong>business investments and exports declined while consumer spending remained flat.</strong>

- <span style="font-size: 22px;"> 
The effects of <strong>interest rate increases</strong> will continue to restrain spending, while limiting growth and employment. 

- <span style="font-size: 22px;"> 
Recent private sector forecasts project either <strong>weak or negative growth over the next two quarters</strong>. 

</span>
]


```{r, echo=FALSE}
monetary <- read_excel("C:/Users/davreuxa/Documents/soe/monetary.xlsx")

monetary1<- monetary %>%
  pivot_longer(-indicator, names_to = "Quarter", values_to = "Value")%>%
  pivot_wider(names_from = `indicator`, values_from = `Value`)

monetary_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = monetary1$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "GDP Quarterly Growth"),
      opposite = FALSE
    ),
    list(
      title = list(text = "Bank of Canada Policy Interest Rate"),
      opposite = TRUE
    )
  ) %>%
  hc_add_series(
    name = "GDP quarterly growth",
    data = monetary1$`GDP Quarterly Growth`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_plotOptions(
    column = list(
      colorByPoint = TRUE,
      colors = ifelse(monetary1$`GDP Quarterly Growth` < 0, "#E31737", "#333F50")
    )
  ) %>%
  hc_add_series(
    name = "Bank of Canada Policy Interest Rate",
    data = monetary1$`Bank of Canada Policy Interest Rate`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada, Table 36-10-0434-01; Gross domestic product (GDP) at basic prices, by industry, monthly (x 1,000,000), Bank of Canada, target for the overnight rate"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )%>%
  hc_subtitle(text="GDP growth, monthly(left, %, Bank of Canada policy interest rate (right,%)")
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6}
monetary_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic dashboard</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Monetary policy</strong></span>
  <span class="small-font" style="margin-left: 100px;">Looking ahead</span>
</div>

---
.center[
##What's the economic outlook?
]

#### The Canadian economy is expected to continueits slowdown through the first half of 2024, while economic activity should improve in the second half of the year.
.pull-left[
- <span style="font-size: 22px;"> 
High interest rates are expected to <strong>dampen business investments </strong> while weaker global demand could reduce exports, causing Canada’s forecasted growth in 2023 and 2024 to be weaker than previously projected.


- <span style="font-size: 22px;"> 
Currently at 5.8% (November 2023), the <strong>unemployment rate is expected to gradually increase to 6.5% by the end of 2024 </strong>as slower hiring rates will continue to cool down a tight labor market.


</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
proj<-highchart() %>%
  hc_chart(type = "line") %>%
  hc_subtitle(text = "Real GDP growth, past and projected, for Canada and the world, yearly percentage change ") %>%
  hc_xAxis(categories = c(2022, 2023, 2024, 2025),
           plotBands = list(
             list(
               from = 0.5,  # Assuming the categories are zero-indexed
               to = 3.5,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = "GDP Growth (%)")) %>%
  hc_add_series(name = "Canada, previous projection", data = c(3.4, 1.8, 1.2, 2.4)) %>%
  hc_add_series(name = "Canada, current projection", data = c(3.4, 1.2, 0.9, 2.5)) %>%
  hc_add_series(name = "World, previous projection", data = c(3.4, 2.8, 2.4, 2.7)) %>%
  hc_add_series(name = "World, current projection", data = c(3.4, 2.9, 2.3, 2.6)) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c('#FFBBAB', '#FF0000', 'grey', 'black')) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Bank of Canada's Monetary Policy Report, July 2023 projections vs. October 2023 projections"
  ) 


```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=8, fig.height=6}
proj
```
]

<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #FE5F55; text-align: center;">
 <span class="small-font"> Economic Dashboard</span> 
  <span class="small-font" style="margin-left: 100px;">Monetary policy</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Looking ahead</strong></span>
</div>
---
<center>
<img src = "currenthead.jpg" width = "70%"/>
</center>
---
.center[
## Elevated public and private debt levels will dampen opportunities for investment 
]

.pull-left[
#### Fiscal capacity is constrained
- <span style="font-size: 17px;"> 
Current federal debt is about 42 per cent of GDP. The government has pledged to run deficits no larger than 1% of GDP (fiscal anchor).
```{r, echo=FALSE, fig.width=6, fig.height=5.5}
feddebt <- read_excel("C:/Users/davreuxa/Documents/soe/feddebttogdp.xlsx")


feddebt_graph <- highchart() %>%
  hc_chart(type = "line") %>%
  hc_subtitle(text = "Federal Debt-to-GDP ratio") %>%
  hc_xAxis(categories = feddebt$Date,
           plotBands = list(
             list(
               from = 7,  # Assuming the categories are zero-indexed
               to = 13,    # 2024 to 2025
               color = "rgba(204, 204, 204, 0.5)"  # Light gray background
             )
           )) %>%
  hc_yAxis(title = list(text = " ")) %>%
  hc_add_series(name = "Actual values ", data = feddebt$`Federal debt to GDP`) %>%
  hc_add_series(name = "Projected values ", 
                data = feddebt$Forecast,
                dashStyle = "Dash") %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(marker = list(enabled = TRUE))) %>%
  hc_tooltip(shared = FALSE, crosshairs = TRUE) %>%
  hc_colors(colors = c("grey", "#A4B9CE")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Fall Economic Statement 2023"
  )

feddebt_graph
```

]
.pull-right[
#### Corporate debt has reached record levels
- <span style="font-size: 17px;"> 
Interest charges reached $22.9 billion in Q3 2023 while banks are bracing for higher insolvencies (see Annex C).
```{r, echo=FALSE, fig.width=7, fig.height=6}
corpdebt <- read_excel("C:/Users/davreuxa/Documents/soe/corpdebt.xlsx")

corpdebt_chart <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_subtitle(text = "Total debt of non-financial corporations(left), and interest rate charges(right)") %>%
  hc_xAxis(categories = corpdebt$Quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "$ billion"),
      opposite = FALSE,
      min=1400,
      max=1800
    ),
    list(
      title = list(text = "%"),
      opposite = TRUE,
      min = 15, # Set the minimum bound
      max = 23  # Set the maximum bound
    )
  ) %>%
  hc_add_series(
    name = "Total debt of non-financial corporations",
    data = corpdebt$`Total debt of non-financial corporations (left)`,
    type = "column", # Specify the series type
    yAxis = 0 # Associate with the first y-axis
  ) %>%
  hc_add_series(
    name = "Interest rate charges",
    data = corpdebt$`Interest charges (right)`,
    type = "line", # Specify the series type
    yAxis = 1 # Associate with the second y-axis
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Quarterly balance sheet, income statement, and selected financial ratios, by non-financial industries, non-seasonally adjusted (billions)."
  ) %>%
  hc_colors(colors = c("#A4B9CE","grey")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    formatter = JS("function () {
      var xAxisValue = this.x;  // Get the x-axis value
      var yAxisValue = this.y;  // Get the y-axis value

      if (this.series.yAxis.options.index === 1) {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '%</b><br>' +
               this.series.name;
      } else {
        return '<b>' + xAxisValue + '</b><br>' +
               '<b>' + Highcharts.numberFormat(yAxisValue, 2) + '</b><br>' +
               this.series.name;
      }
    }")
  )

corpdebt_chart
```

]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> <strong>Debt</strong></span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Canadian households are under pressure
]

#### Affordibility remains a key issue, creating a drag on consumption. 

.pull-left[
- <span style="font-size: 22px;"> 
<strong>High demand from population growth and a lack of supply </strong>in the housing market have offset gains in household income.

- <span style="font-size: 22px;"> 
The Bank of Canada’s <strong>housing affordability index reached its highest level </strong>— meaning the worst degree of affordability — since 1982.

- <span style="font-size: 22px;"> 
Households are allocating a higher portion of their income to housing, using up more than 38% in 2022, a 4% increase compared to 2019.

- <span style="font-size: 22px;"> 
The average household is spending around 15 cents of every after-tax dollar to service their debt – the highest since 1990.

</span>
]

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=7}
housecost <- read_excel("C:/Users/davreuxa/Documents/soe/housecost.xlsx")

housecost_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = housecost$Date) %>%
  hc_add_series(
    name = "Housing affordability index, quarterly",
    data = housecost$`Value`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%"),
    plotLines = list(
      list(
        color = '#446992',          # Color of the dashed line
        width = 2,              # Width of the line
        dashStyle = 'Dash',     # Style of the line
        value = 0.55,           # The y-value where the dashed line is drawn
        zIndex = 5,             # Ensures that the line is above the plot
        label = list(
          text = 'Highest level in 41 years',
          align = 'right',
          style = list(
            color = '#446992'
          )
        )
      )
    )
  ) %>%
  hc_caption(
    text = "Source: Bank of Canada, Housing Affordibility."
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Housing costs are taking an ever increasing share of households' income") %>%
  hc_subtitle(text="Housing affordability index, quarterly")%>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_legend(enabled = FALSE) 


# To display the chart if you're running this in an interactive R session
housecost_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
  <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;"><strong>Affordability</strong> </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
    <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Inflationary pressures might be easing
]

#### Recent inflation numbers are the lastest sign of a cooling economy 
.pull-left[
- <span style="font-size: 22px;"> 
Canada's <strong> consumer price index rose by 3.1% </strong> in the year up to October, down from 3.8% the rpevious month. 

- <span style="font-size: 22px;"> 
Overall, <strong>shelter costs (e.g. mortgage and rent payments) are up by more than six% </strong> in the past year. That's about twice the overall inflation rate.

- <span style="font-size: 22px;"> 
<strong>CPI – food purchased from stores was 5.6%.</strong> Grocery prices have now decelerated for four months in a row.

- <span style="font-size: 22px;"> 
Historical experience suggests that the recent easing of cost pressures in production and distribution (see Annex A) will lead to <strong>further declines in food price inflation </strong>over the coming months.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.width=7.5, fig.height=7}
foodinf <- read_excel("C:/Users/davreuxa/Documents/soe/foodinf.xlsx")

foodinf_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = format(as.Date(foodinf$Date), "%b %y")) %>%
  hc_add_series(
    name = "Food Inflation",
    data = foodinf$`Food Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "Headline Inflation",
    data = foodinf$`Headline Inflation`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: Statistics Canada. Table 18-10-0006-01 Consumer Price Index, monthly"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_title(text = "Food inflation continues to decrease from its January 2023 peak, getting closer to the all-items inflation") %>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_subtitle(text="Year-over-year inflation, monthly (%)")

# To display the chart if you're running this in an interactive R session


foodinf_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Inflation</strong></span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##There are risks of a wage-price spiral
]

#### Wages are catching up with inflation, adding cost pressures to firms

.pull-left[
- <span style="font-size: 22px;"> 
<strong>Wage hikes have become more widespread </strong>as workers try to recoup purchasing power including via several high-profile strikes across Canada.

- <span style="font-size: 22px;"> 
The <strong>cost of labour rose faster </strong>than the increase in price of the products sold for the better part of the year (see chart).

- <span style="font-size: 22px;"> 
Though faster wage increases are an understandable reaction to higher inflation, they risk making a <strong>return to low inflation </strong>more difficult.


</span>
]
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6, warning=FALSE}
cons <- read_excel("C:/Users/davreuxa/Documents/soe/construction.xlsx")


const <- highchart() %>%
  hc_chart(type = "column", zoomType = "xy") %>%
  hc_xAxis(categories = cons$Quarter) %>%
  hc_add_series(
    name = "Change in the cost of labor",
    data = cons$`Change in the cost of labor`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "Change in the price of goods sold",
    data = cons$`Change in the price of goods sold`,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source: StatsCan Table 36-10-0206-01 Indexes of business sector labour productivity, unit labour cost and related measures, seasonally adjusted."
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  )%>%
  hc_subtitle(text = "Quarterly change in the unit labor cost, and the implicit price deflator, percentage")%>%
  hc_title(text="The increase in costs of wages has outpaced the increase in prices of products sold for businesses for four consecutive quarters, before an uptick in prices.")%>%
  hc_colors(colors = c("grey", "#A4B9CE"))%>%
  hc_add_annotation( 
  labels = list(
    list(
      point = list(
        xAxis = 0,
        yAxis = 0,
        x = 6,
        y = 2
      ),
      text = "The cost of labour has increased     </br />
              faster than the rise in prices <br />",
      draggable = FALSE,  # Set draggable to TRUE or FALSE
      labelOptions = list(
        shape = 'connector',
        align = 'right',
        justify = FALSE,
        crop = FALSE,
        style = list(
          fontSize = '10px',
          textOutline = '1px white'
        )
      )
    )
  )
)
```

.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=7}
const
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;"><strong>Inflation</strong></span>
  <span class="small-font" style="margin-left: 100px;">Productivity</span>

</div>
---
.center[
##Tackling weak productivity growth is critical
]

#### Canada’s productivity has dipped below pre-pandemic levels while widening the gap with the US
.pull-left[
- <span style="font-size: 22px;"> 
Wage increases would be <strong>non-inflationary with higher productivity </strong> but that is not the case in Canada. 

- <span style="font-size: 22px;"> 
<strong>Canada needs to alter its current productivity course</strong> or be destined to enter an era of reduced consumption and declining living standards.

- <span style="font-size: 22px;"> 
Over the past four years, <strong>output per hour in the business sector has dropped at a 0.2% annual rate</strong>, the first negative reading on record over such a sustained period, whereas it has increased by 1.4% in the US (see chart). 
</span>
]
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=7}
LP <- read_excel("C:/Users/davreuxa/Documents/soe/LP.xlsx")

lp_chart<- highchart() %>%
  hc_chart(type = "line", zoomType = "xy") %>%
  hc_xAxis(categories = LP$Quarter) %>%
  hc_add_series(
    name = "Canada",
    data = LP$Canada,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_add_series(
    name = "US",
    data = LP$US,
    dataLabels = list(enabled = FALSE, format = '{point.y:.2f}%')
  ) %>%
  hc_yAxis(
    title = list(text = "%")
  ) %>%
  hc_caption(
    text = "Source:Statistics Canada, US Federal Reserve Economic Data"
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_subtitle(text = "Labour productivity in the business sector, Canada vs. US, annualized 4-year change (%)") %>%
  hc_title(text="Canada's labour productivity growth is now below pre-pandemic levels")%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))%>%
  hc_add_annotation( 
  labels = list(
    list(
      point = list(
        xAxis = 0,
        yAxis = 0,
        x = 110,
        y = 1
      ),
      text = "The productivity gap between Canada    ,</br />
              and the U.S. is increasing <br />",
      draggable = FALSE,  # Set draggable to TRUE or FALSE
      labelOptions = list(
        shape = 'connector',
        align = 'center',
        justify = FALSE,
        crop = TRUE,
        style = list(
          fontSize = '10px',
          textOutline = '1px white'
        )
      )
    )
  )
)

lp_chart
```
]
<div class="subpoints" style="position: absolute; top: 0; left: 0; width: 100%; padding: 10px; background-color: #A4B9CE; text-align: center;">
 <span class="small-font"> Debt</span> 
  <span class="small-font" style="margin-left: 100px;">Affordability </span>
  <span class="small-font" style="margin-left: 100px;">Inflation</span>
  <span class="small-font" style="margin-left: 100px;"><strong>Productivity</strong></span>

</div>
---
<center>
<img src = "blueprint.jpg" width = "60%"/>
</center>
---

```{r, echo=FALSE,  include=FALSE}
TFP <- read_excel("C:/Users/davreuxa/Documents/soe/TFP.xlsx")

multiplier <- 100

# Apply the multiplier to all columns except 'Date'
TFP[, -which(names(TFP) == "Date")] <- TFP[, -which(names(TFP) == "Date")] * multiplier


labor_growth_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Labour Productivity Growth") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$LP_Can)%>%
  hc_add_series(name = "USA", data = TFP$LP_US) %>%
   hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  #hc_subtitle(text="Canada-U.S. Decomposition of Labour Productivity Growth, 1987-2021")


capital_deepening_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Capital Deepening") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$CD_Can)%>%
  hc_add_series(name = "USA", data = TFP$CD_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))%>%
  hc_title(text="Canada-U.S. Decomposition of Labour Productivity Growth, 1987-2021")
  
skills_composition_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Skills Composition") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$SC_Can) %>%
  hc_add_series(name = "USA", data = TFP$SC_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  
total_factor_productivity_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_subtitle(text = "Total Factor Productivity") %>%
  hc_xAxis(categories = TFP$Date) %>%
  hc_add_series(name = "Canada", data = TFP$TFP_Can)%>%
  hc_add_series(name = "USA", data = TFP$TFP_US) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared = TRUE
  ) %>%
  hc_legend(enabled = FALSE)%>%
  hc_caption(
    text = "Source: Canada: Statistics Canada Table 36-10-0208-01; U.S. Bureau of Labour Statistics; ISED calculations."
  ) %>%
  hc_colors(colors = c("#FE5F55", "#A4B9CE"))
  

labor_growth_chart
capital_deepening_chart
skills_composition_chart
total_factor_productivity_chart
```

.pull-left[
##Canada's weak productivity growth requires firms to make better use of physical and human capital

<ul style="font-size: 20px;"> 
  <li>
    Labour productivity rises through:
    <ul>
      <li>More structures, machines, and intangible assets <strong>(capital deepening)</strong>.</li>
      <li>More skills <strong>(skill composition of labour force)</strong>.</li>
      <li>More effective use of the above inputs <strong>(total factor productivity)</strong>.</li>
    </ul>
  </li>
 </ul>
 
<ul style="font-size: 20px;"> 
  <li>
    Canada’s lower relative labour productivity is driven by weakness in <strong>total factor productivity growth</strong>, which has not improved in decades.
  </li>
</ul>

<ul style="font-size: 20px;"> 
  <li>
    <strong>Total factor productivity</strong> is a measure of overall effectiveness with which inputs (capital and labour) are used to produce output in an economy. It is a <strong>measure of technological progress and innovation.</strong>
  </li>
</ul>


]
.pull-right[
<div class="slide-content">
<div class="text-container">
<!-- Replace this with your slide text content -->

</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=3.25}
# Assuming the chart object is created and named capital_deepening_chart
capital_deepening_chart
```
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=2.5}
# Assuming the chart object is created and named skills_composition_chart
skills_composition_chart
```
```{r,echo=FALSE,results='asis',fig.width=6, fig.height=3.5}
# Assuming the chart object is created and named total_factor_productivity_chart
total_factor_productivity_chart
```
</div>
</div>
]

---

```{r, echo=FALSE, include=FALSE}
IPP<-read_excel("C:/Users/davreuxa/Documents/soe/IPP.xlsx")

assign_colors <- function(values, country_names, highlight_country, color_default, color_highlight) {
  colored_values <- lapply(seq_along(values), function(i) {
    if (country_names[i] == highlight_country) {
      list(y = values[i], color = color_highlight)
    } else {
      list(y = values[i], color = color_default)
    }
  })
  return(colored_values)
}

IPP$Total_ME_IPP <- IPP$`M&E` + IPP$`IPP`
IPP <- IPP[order(IPP$`Total_ME_IPP`, decreasing = TRUE),]

# Prepare the data for "Canada" to be highlighted
m_e_colored <- assign_colors(IPP$`M&E`, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')
ipp_colored <- assign_colors(IPP$IPP, IPP$Country, "Canada", '#D7D7D7', '#FFB3AF')
non_res_colored <- assign_colors(IPP$Non_res, IPP$Country, "Canada", '#7F7F7F', '#FE5F55')

m_e_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
  hc_subtitle(text = "Machinery & Equipment + Intellectual Property Products") %>%
  #hc_title(text="Gross fixed capital formation by asset category (percentage of GDP, 2021)")%>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_add_series(name = "M&E", data = m_e_colored) %>%
  hc_add_series(name = "IPP", data = ipp_colored) %>%
  hc_xAxis(categories = IPP$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)%>%
  hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_yAxis(labels = list(style = list(textOverflow = "allow")))%>%
  hc_caption(text="Source: OECD.")

```
```{r, echo=FALSE, include=FALSE}
IPP2<-read_excel("C:/Users/davreuxa/Documents/soe/IPP.xlsx")

IPP2 <- IPP2[order(IPP2$Non_res, decreasing = TRUE),]

non_res_colored <- assign_colors(IPP2$Non_res, IPP2$Country, "Canada", '#7F7F7F', '#FE5F55')

# Generate the bar chart for Non-residential Structures with highlighted "Canada"
non_res_chart <- highchart() %>%
  hc_chart(type = "bar") %>%
    hc_subtitle(text = "Non-residential Structures") %>%
  hc_add_series(name = "Non-residential Structures", data = non_res_colored) %>%
  hc_xAxis(categories = IPP2$Country) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
    hc_add_theme(hc_theme_bloom()) %>%
  hc_legend(enabled = FALSE)%>%
  hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_yAxis(labels = list(style = list(textOverflow = "allow")))
non_res_chart
```
.center[
### More needs to be done to encourage firms to invest in productivity enhancing assets
]

.pull-left[
- <span style="font-size: 20px;"> 
<strong>It is not just an R&D story - Canadian businesses invest proportionally less </strong>in machinery & equipment and other IP products (e.g., software and data).

</span>
  
- <span style="font-size: 20px;">
Most businesses are not R&D performers but can contribute to <strong>productivity growth by investing </strong>in technologies and the knowledge and skills to effectively use them.  
</span>

- <span style="font-size: 20px;">
Investing in both machinery and knowledge supports a healthy <strong>innovation ecosystem </strong>– critical for  economic growth, and overall competitiveness. 
</span>


]
.pull-right[
#### Gross fixed capital formation by asset category (percentage of GDP, 2021)
.pull-left[
```{r,echo=FALSE,results='asis',fig.width=3.5, fig.height=6.25}
m_e_chart
```
]
.pull-right[
```{r,echo=FALSE,results='asis',fig.width=4, fig.height=6.25}
non_res_chart
```
]
]

---
.center[
## New sources of productivity growth will be required to adjust for the green transition
]
.pull-left[
- <span style="font-size: 22px;"> 
The <strong>green transition </strong>will create challenges and opportunities for productivity growth. 

- <span style="font-size: 22px;"> 
In addition to oil and gas, the Canadian economy is <strong>heavily concentrated </strong>within resource-dependent industries. 

- <span style="font-size: 22px;"> 
Among G7 countries, <strong>Canada has the highest value added share of resource-dependent industries</strong> (see chart).

- <span style="font-size: 22px;"> 
Economic concentration in resource-dependant industries creates <strong>less investment opportunities in more complex manufacturing and services </strong>.

</span>
]


```{r, echo=FALSE, include=FALSE}
green <- read_excel("C:/Users/davreuxa/Documents/soe/green.xlsx")

green_long <- green %>% 
  pivot_longer(cols = -Date, names_to = "Country", values_to = "Value") %>%
  mutate(Date = as.character(Date)) # Convert Date to character for plotting

gchart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text="Canada's production has become less resouce heavy, but continues to be the highest within the G7")%>%
  hc_subtitle(text = "GDP share of Resource-Dependant Activities, 2000 vs 2019") %>%
  hc_xAxis(categories = unique(green_long$Country)) %>%
  hc_yAxis(title = list(text = "%")) %>%
  hc_add_series(name = "2000", 
                data = filter(green_long, Date == "2000") %>% 
                  arrange(Country) %>% 
                  pull(Value),
                color = "#AFABAB") %>%
  hc_add_series(name = "2019", 
                data = filter(green_long, Date == "2019") %>% 
                  arrange(Country) %>% 
                  pull(Value),
                color = "#A4B9CE") %>%
  hc_legend(enabled = TRUE)%>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.2f}%</b><br/>',
    shared=TRUE
  ) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(text = "Source: OECD.") 



```
.pull-right[
```{r, echo=FALSE, fig.align='center',fig.width=7.5, fig.height=7}
gchart
```
]

---
```{r,echo=FALSE, include=FALSE}
data <- tibble(
  category = c('Labour Productivity', 'Revenue Growth', 'Employment Growth'),
  cleantech = c(14300, 13.3, 6.5),
  other = c(13500, 7.2, 2.4)
)

# Labour Productivity Chart
lp_chart <- highchart() %>%
  hc_title(text="Clean tech support vs. other innovation support, median 3 year change (2018-21)")%>%
  hc_add_series(name = "Clean-tech Support", data = list(list(name = data$category[1], y = data$cleantech[1])),
                type = 'bar', color = "#CA6F07",
                tooltip = list(valueDecimals = 0, valueSuffix = 'USD')) %>%
  hc_add_series(name = "Other Innovation Support", data = list(list(name = data$category[1], y = data$other[1])),
                type = 'bar', color = "#FBC78D",
                tooltip = list(valueDecimals = 0, valueSuffix = 'USD')) %>%
  hc_subtitle(text = "Labour Productivity") %>%
  hc_xAxis(categories = c(" ")) %>%
  hc_legend(enabled = TRUE)%>%
    hc_add_theme(hc_theme_bloom()) %>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )
       
# Revenue Growth Chart

rg_chart <- highchart() %>%
  hc_chart(type = 'bar') %>%
  hc_subtitle(text = "Revenue Growth") %>%
  hc_xAxis(categories = c(" ")) %>%
    hc_legend(enabled = TRUE)%>%
  hc_add_series(name = "Clean-tech Support", data = c(13.3),
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_add_series(name = "Other Innovation Support", data = c(7.2),
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_plotOptions(
    series = list(
      dataLabels = list(enabled = FALSE)
    )
  ) %>%
  hc_legend(enabled = TRUE)%>%
    hc_add_theme(hc_theme_bloom())%>%
  hc_colors(colors = c('light grey',"#AFABAB"))%>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )


# Employment Growth Chart
eg_chart <- highchart() %>%
  hc_add_series(name = "Clean-tech Support", data = list(list(name = data$category[3], y = data$cleantech[3])),
                type = 'bar', color = "#263E5A",
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_add_series(name = "Other Innovation Support", data = list(list(name = data$category[3], y = data$other[3])),
                type = 'bar', color = "#A4B9CE",
                tooltip = list(valueDecimals = 1, valueSuffix = '%')) %>%
  hc_subtitle(text = "Employment Growth") %>%
  hc_xAxis(categories = c(" ")) %>%
   hc_plotOptions(
    series = list(
      dataLabels = list(enabled = FALSE)
    )
  )%>%
  hc_add_theme(hc_theme_bloom()) %>%
    hc_legend(enabled = FALSE)%>%
    hc_yAxis(
    maxPadding = 0.1, # Adds 10% padding above the highest data point
    endOnTick = FALSE, # Prevents the axis from ending exactly on the last tick
    showLastLabel = TRUE, # Ensures the last label is displayed
    tickPixelInterval = 50 # Adjust the pixel interval for ticks
  )%>%
  hc_legend(enabled = TRUE)%>%
  hc_caption(
    text = "Source: Carta M., and Demers, F. (2023); Analysis on Federal Business Innovation and Growth Support to Clean Technology, 2016-2020."
  )

```

.pull-left[
## Investments in clean-tech can unlock new productivity opportunities
<ul style="font-size: 20px;"> 
  <li>
The Porter Hypothesis posits that well-formulated <strong>environmental policies can spur innovation</strong>, which can in turn stimulate productivity.
  </li>
 </ul>
 
<ul style="font-size: 20px;"> 
  <li>
There is emerging evidence in Canada that the <strong>environmental and clean technology sector</strong> is generating above-average productivity returns. 
  </li>
</ul>

<ul style="font-size: 20px;"> 
  <li>
A recent study finds that—relative to other innovation support beneficiaries—businesses getting clean-tech support: 
    <ul>
      <li>had more educated workforces;</li>
      <li>faster labour productivity growth;</li>
      <li>faster revenue growth, and;</li>
      <li>faster employment growth compared to businesses receiving other innovation support programs. </li>
    </ul>
  </li>
</ul>
]

.pull-right[
<div class="text-container">
<!-- Your text content goes here -->
</div>

<div class="charts-container">
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=3.35}
lp_chart
```
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=2.80}
rg_chart
```
```{r,echo=FALSE,results='asis',fig.width=6.5, fig.height=3.25}
eg_chart
```
</div>
]

---
.center[
##The shift towards electric vehicles requires urgent action to build out the supply chain
]

#### Canada possesses critical minerals but lacks processing capacity, hampering productivity.
.pull-left[
- <span style="font-size: 22px;"> 
Canadian sales of <strong>EVs jumped by 30% in Q2 2023 </strong>compared to the previous quarter (see chart).

- <span style="font-size: 22px;"> 
Since 2020, Canada has secured more than <strong>$34 billion in investment in the batteries and automotive supply chain.</strong>

- <span style="font-size: 22px;"> 
However, the domestic EV supply chain is still lagging in its <strong>capacity to process the raw materials going into the battery cells.</strong>

- <span style="font-size: 22px;"> 
The US Inflation Reduction Act and China’s dominant position in critical mineral processing (IMF) puts further <strong>pressure on Canada’s capability to secure its own supply chain in EV batteries.</strong>

</span>
]
```{r, echo=FALSE, include=FALSE}
ev <- read_excel("C:/Users/davreuxa/Documents/soe/ev.xlsx")


ev_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text="EV sales numbers have been soaring in the past two quarters")%>%
  hc_subtitle(text = "EV registrations, quarterly (left, thousands) and share of total vehicle sales(right, %)") %>%
  hc_xAxis(categories = ev$quarter) %>%
  hc_yAxis_multiples(
    list(
      title = list(text = "thousands"),
      opposite = FALSE,
      min=0,
      max=60
      ),
    list(
      title = list(text = "%"), 
      opposite = TRUE
      )
  ) %>%
  hc_add_series(name = "Battery electric", data = ev$battery_electric, type = "column", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = 'k')) %>%
  hc_add_series(name = "Plug-in hybrid electric", data = ev$plugin_hybrid, type = "column", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = 'k')) %>%
  hc_add_series(name = "Share of Sales", data = ev$share_of_sales, type = "line", yAxis = 1, marker = list(enabled = TRUE),
                tooltip = list(valueDecimals = 2, valueSuffix = '%')) %>%
  hc_plotOptions(column = list(stacking = 'normal')) %>%
  hc_legend(enabled = TRUE) %>%
  hc_credits(enabled = FALSE)%>%
  hc_colors(colors = c("#A4B9CE","#AFABAB", "grey"  )) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_caption(
    text = "Source: Statistics Canada. Table 20-10-0024-01. New motor vehicle registrations, quarterly."
  )


```

.pull-right[

```{r,echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.75}
ev_chart
```
]

---
.center[
##Policies should continue to work with firms along their digitization journey
]

.pull-left[
- <span style="font-size: 22px;"> 
Digital-intensive sectors, associated with significant <strong>productivity gains, </strong>accounted for 6% of Canada’s GDP in 2020, lagging most G7 peers (see chart).

- <span style="font-size: 22px;"> 
<strong>SMEs continue to lag larger firms in foundational technologies,</strong> such as e-commerce and social media, thus leaving money on the table in an increasingly digital market. <strong>Limited access to high-speed internet, skills shortages, and corporate giants </strong>are a few of the main barriers prohibiting SME firms from digitizing.

- <span style="font-size: 22px;"> 
Canada’s skilled workforce and early investment in AI technologies can facilitate a better integration of digital tools in its economy.

</span>
]
.pull-right[
```{r, echo=FALSE, fig.align='center',fig.width=7.5, fig.height=7}
DII <- read_excel("C:/Users/davreuxa/Documents/soe/DII.xlsx")

dii_chart <- highchart() %>%
  hc_chart(type = "column") %>%
  hc_title(text = "Contribution to value added growth by digital intensity sectors") %>%
  hc_xAxis(categories = DII$Country) %>%
hc_yAxis(
    title = list(text = "%"),
    min = -5, # Set the minimum bound
    max = 100  # Set the maximum bound
  ) %>%
  hc_plotOptions(column = list(stacking = 'normal')) %>%
  hc_add_series(name = "High digital-intensive industries", data = DII$`High digital-intensive industries`, color = "#0E3A55") %>%
  hc_add_series(name = "Medium-high digital-intensive industries", data = DII$`Medium-high digital-intensive industries`, color = "#B7D7E2") %>%
  hc_add_series(name = "Medium-low digital-intensive industries", data = DII$`Medium-low digital-intensive industries`, color = "#DCD3CC") %>%
  hc_add_series(name = "Low digital-intensive industries", data = DII$`Low digital-intensive industries`, color = "#FE5F55") %>%
  #hc_add_series(name = "Annual real value added growth", data = DII$`Annual real value added growth`, color = "#1aadce", type = "scatter", 
                #marker = list(lineWidth = 2, lineColor = "black", fillColor = "white"), 
                #dataLabels = list(enabled = TRUE, format = '{point.y:.2f}%', style = list(fontSize = '13px'))) %>%
  hc_legend(enabled = TRUE) %>%
  hc_credits(enabled = FALSE)%>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(
    pointFormat = '{series.name}: <b>{point.y:.1f}%</b><br/>',
    shared=TRUE
  ) %>%
  hc_caption(
    text = "Source: Digitally Intensive Sectors determined using methodology by Calvino et al (2018); data from the OECD"
  )


# Print the chart
dii_chart
```
]

---
.center[
##Working closer with firms on how they deploy human capital is worth exploring
]

#### Labour shortages can be good news for productivity
.pull-left[
- <span style="font-size: 22px;"> 
<strong>Labour market tightness remains elevated, </strong>making life difficult for some businesses.

- <span style="font-size: 22px;"> 
<strong>Job vacancies declined to 632,200 </strong>in September 2023. but remain well above pre-COVID levels.


- <span style="font-size: 22px;"> 
Persistent job vacancies in some sectors can be an opportunity for <strong>digital transformation.</strong> When employers pay more for labour, they have an incentive to use it more, which can spark innovation, investments in technology (e.g. AI and automation) and productivity improvements.

- <span style="font-size: 22px;"> 
Canada could look to the UK, Finland, and Australia, where innovation policies have spotlighted the role of HR and management practices.

</span>
]
```{r, echo=FALSE, include=FALSE}
vacancy <- read_excel("C:/Users/davreuxa/Documents/soe/vacancy.xlsx")

vacancy_graph <-highchart() %>%
  hc_chart(type = "line") %>%
  hc_title(text = "Vacancies continue to decline as the number of available worker per open position nearly doubles since last year.") %>%
  hc_xAxis(categories = format(as.Date(vacancy$Date), "%b %y")) %>%  
  hc_yAxis_multiples(
    list(title = list(text = " ")),
    list(title = list(text = " "), opposite = TRUE)
  ) %>%
 hc_add_series(name = "Unemployment-to-job Vacancies", data = vacancy$unemp, type = "line", yAxis = 0,
                tooltip = list(valueDecimals = 2, valueSuffix = ' ')) %>%
  hc_add_series(name = "Job vacancies", data = vacancy$vacancy, type = "line", yAxis = 1,
                tooltip = list(valueDecimals = 0, valueSuffix = ' ')) %>% 
  hc_legend(enabled = FALSE) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE)%>%
  hc_colors(colors = c("#A4B9CE","#AFABAB")) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_caption(
    text = "Source: Statistics Canada. Labour force characteristics and job vacancies."
  ) %>%
  hc_subtitle(text="Unemployment-to-job vacancy ratio (left) and job vacancies (right), monthly")
```
.pull-right[
```{r, echo=FALSE, fig.align='center', fig.width=7.5, fig.height=6.25}
vacancy_graph
```
]

---
.pull-left[
## Policy considerations
<img src="policy.jpg" width="75%"/>
]

- <span style="font-size: 25px;"> 
The Canadian economy may struggle to grow in the near-term. 

<span style="font-size: 25px;"> 
  <strong>ISED policies and programs should prepare for different economic downturn scenarios within a tight fiscal framework.</strong>


- <span style="font-size: 25px;"> 
ISED could look to orient policies and programs to <strong>work closer with firms to increase business investments to accelerate innovation,</strong> while also deploying the right mix of inputs, including technology and intangible assets (e.g. human capital) to <strong>lift productivity growth.</strong>


- <span style="font-size: 25px;"> 
While recent Competition Act reforms are critical, examine how other <strong>structural policies </strong>(e.g. those that shape the business environment) can be adjusted to address <strong>underlying economic challenges in Canada and promote sustainable growth. </strong>

</span>

---

## Appendix
###Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels
```{r, echo=FALSE, include=FALSE}

# Create a data frame with the GDP growth information
gdp_growth <- data.frame(
  Industry = c(
    "Professional services", "Public administration", "Finance and insurance", 
    "Health care and social assistance", "Educational services", "Real estate and rental and leasing", 
    "Retail trade", "Information and cultural industries", "Other services", "Wholesale trade", 
    "Energy and mining", "Manufacturing", "Construction", "Transportation and warehousing", 
    "Utilities", "Administrative and support", "Accommodation and food services", 
    "Agriculture, forestry, fishing and hunting", "Arts, entertainment and recreation"
  ),
  RelativeToPrePandemic = c(
    11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -0.2, -2.4, 
    -4.1, -5.3, -7.0, -8.9, -7.3
  ),
  PastYear = c(
    1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -0.7, 4.5, 
    -6.4, 0.1, 0.0, -15.7, 7.4
  ),
  PastThreeMonths = c(
    -0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, 
    -2.2, -0.6, -1.0, 1.0, -7.5
  )
)

# Create the Highchart
sect<-highchart() %>%
  hc_chart(type = "bar") %>%
  hc_title(text = "Sector Snapshot") %>%
  hc_subtitle(text = "Tourism and Transportation have yet to recover from the Pandemic while Construction and Agriculture dip back below their pre-pandemic levels") %>%
  hc_xAxis(categories = gdp_growth$Industry) %>%
  hc_yAxis(title = list(text = "GDP growth (%)")) %>%
  hc_add_series(name = "Relative to pre-pandemic", data = gdp_growth$RelativeToPrePandemic) %>%
  hc_add_series(name = "Past year", data = gdp_growth$PastYear) %>%
  hc_add_series(name = "Past three months", data = gdp_growth$PastThreeMonths) %>%
  hc_legend(enabled = TRUE) %>%
  hc_plotOptions(series = list(stacking = "normal")) %>%
  hc_tooltip(pointFormat = "<span style='color:{point.color}'>\u25CF</span> {series.name}: <b>{point.y}%</b><br/>")

sect

```
```{r,echo=FALSE}
industries <- c("Professional services", "Public administration", "Finance and insurance",
                "Health care and social assistance", "Educational services",
                "Real estate and rental and leasing", "Retail trade",
                "Information and cultural industries", "Other services", "Wholesale trade",
                "Energy and mining", "Manufacturing", "Construction",
                "Transportation and warehousing", "Utilities", "Administrative and support",
                "Accommodation and food services", "Agriculture, forestry, fishing and hunting",
                "Arts, entertainment and recreation")

pre_pandemic <- c(11.6, 9.1, 8.7, 8.6, 6.7, 5.8, 3.4, 3.4, 3.2, 2.3, 1.3, 0.2, -1.2, -2.4, -4.1, -5.3, -7.0, -7.3, -8.9)
past_year <- c(1.8, 3.6, 1.2, 2.9, 2.7, 2.2, -0.8, -0.9, 1.3, 1.7, 0.9, -0.2, -1.7, 4.5, -6.4, 0.1, 0.0, -15.7, 7.4)
past_three_months <- c(-0.2, 0.9, 0.7, 0.6, 0.3, 0.4, -1.3, -1.8, -0.1, 0.8, 3.2, -2.0, -0.7, 0.1, -2.2, -0.6, -1.0, 1.0, -7.5)

# Create a list of lists for highcharter
data_for_chart <- list(
  list(name = 'Relative to pre-pandemic', data = pre_pandemic),
  list(name = 'Past year', data = past_year),
  list(name = 'Past three months', data = past_three_months)
)

# Create the Highchart
sect2<-highchart() %>%
  hc_chart(type = 'bar') %>%
  hc_title(text = "GDP growth by industry, as of August 2023, percentage") %>%
  hc_xAxis(categories = industries) %>%
  hc_yAxis(title = list(text = "Growth (%)")) %>%
  hc_add_series_list(data_for_chart) %>%
  hc_plotOptions(series = list(stacking = 'normal')) %>%
  hc_legend(reversed = TRUE) %>%
  hc_add_theme(hc_theme_bloom()) %>%
  hc_tooltip(shared = TRUE, crosshairs = TRUE) 
  #hc_exporting(enabled = TRUE) # Enable chart exporting (optional)

```
<center>
```{r, echo=FALSE, fig.align='center', fig.width=10, fig.height=6}
sect2
```
</center>


---
class: center, middle, inverse

<div style="text-align: center; vertical-align: middle; height: 50%;">
  <h1>Thank-you</h1>
</div>

